{
  "hash": "c9257ecb819db8ceafc09f2e7fac9fa8",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute:\n  echo: true\n  eval: false\n  error: false\n---\n\n\n\n\n## Rstudio project to Zenodo exercise {#sec-Rproj_zenodo_exercise}\nThe following exercise is heavily based on [@blondel2024]. We have extracted the most relevant parts to explain the workflow. If you are interested in more details, check out their user manual at: https://cran.r-project.org/web/packages/zen4R/vignettes/zen4R.html.\n\n### Step 1: Install zen4R to access Zenodo through r\nFor this exercise we will not be using Zenodo directly but Zenodo Sandbox. The Zenodo Sandbox is a separate, secure testing environment where users can explore Zenodo’s features without impacting the main platform's publicly accessible data. It allows you to test file uploads, generate test DOIs, and experiment with API integrations. DOIs created in the sandbox are only for testing and use a different prefix. You will need a separate account and access token for the sandbox, distinct from those used on Zenodo’s main site.\n\n-   Create an account on https://sandbox.zenodo.org.\n\nZenodo can be accessed with r library zen4R to upload, edit, publish and download data.\n\n-   Install zen4R library with the following code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install dependency \"remotes\"\ninstall.packages(\"remotes\")\n    \n#install zen4R\nrequire(\"remotes\")\ninstall_github(\"eblondel/zen4R\")\n```\n:::\n\n\n\n### Step 2: Create a new Zenodo record\nA zenodo record includes metadata, data and a  Digital Object Identifier (DOI) which is automatically generated by Zenodo for all uploads. But before you can add records to Zenodo, you need to access your own account through RStudio. \n\n-   Go to https://sandbox.zenodo.org/account/settings/applications/.\n-   Log into your account and then create a new \"Personal access token\" in the \"Applications\" section of your account.\n-   Then run the following code in RStudio to establish the access and create a new record.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(zen4R)\n    \n#Create manager to access your Zenodo repository\nzenodo <- ZenodoManager$new(\ntoken = \"your_token\",\nsandbox = TRUE,\nlogger = \"INFO\" \n)\n    \n#Create a new empty record\nmyrec <- ZenodoRecord$new()\n```\n:::\n\n\nIf you want to connect to Zenodo and not the Zenodo sandbox, create the token in your Zenodo account and remove the sandbox = True line in the code above.\n\n\nThe types of metadata that can be included in a Zenodo record are vast. A full list can be found in the documentation at https://developers.zenodo.org/#representation. The code below gives some examples.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmyrec$setTitle(\"zen4R\") #title of the record\nmyrec$addAdditionalTitle(\"This is an alternative title\", type = \"alternative-title\")\nmyrec$setDescription(\"Interface to 'Zenodo' REST API\") #description\nmyrec$addAdditionalDescription(\"This is an abstract\", type = \"abstract\")\nmyrec$setPublicationDate(\"2024-09-16\") #Format YYYY-MM-DD\nmyrec$setResourceType(\"dataset\")\nmyrec$addCreator(firstname = \"Yourfirstname\", lastname = \"Yourlastname\", role = \"datamanager\", orcid = \"0000-0001-0002-0003\")\nmyrec$setKeywords(c(\"R\",\"dataset\")) #For filtering\nmyrec$addReference(\"Blondel E. et al., 2024 zen4R: R Interface to Zenodo REST API\")\nmyrec$setPublisher(\"CRAN\") #Publisher\n```\n:::\n\n\n    \nA record can be deposited on Zenodo before it is published. This will add the record to your account without making it public yet. A deposited record can still be edited or deleted. You can also upload data to a deposited record. If you prefer a graphical interface, you can also edit the record on the Zenodo website.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#deposit record\nmyrec <- zenodo$depositRecord(myrec, publish = TRUE)\n\n#add data to the record, adjust the path below\nzenodo$uploadFile(\"path/to/your/file\", record = myrec)\n\n#delete record if you want to start over\nzenodo$deleteRecord(myrec$id)\n```\n:::\n\n\n\n\nOnce you are satisfied with the record, you can proceed with its publication.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#publish record\nmyrec <- zenodo$publishRecord(myrec$id)\n```\n:::\n\n\n    \n### Step 3: Edit a published Zenodo record\nIt is also possible to edit or update the metadata of published records.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#get your record by metadata query, e.g. by title\nmyrec <- zenodo$getDepositions(q='title:zen4R')\n\n#get depositions creates a list, access first element\nmyrec <- myrec[[1]]\n\n#edit metadata\nmyrec <- zenodo$editRecord(myrec$id)\nmyrec$setTitle(\"zen4R 2.0\")\n\n#redeposit and publish the edited record\nmyrec <- zenodo$depositRecord(myrec, publish = TRUE)\n```\n:::\n\n\n\nOnce a record has been published, it is not possible to edit the data that has been attached to it. However, it is possible to upload an updated version of the data. The previous version of the data will remain accessible via Zenodo. The record will have one overall DOI, while each version will have its own DOI.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# reconnect to your account if necessary\nzenodo <- ZenodoManager$new(\n  token = \"your_token\",\n  sandbox = TRUE,\n  logger = \"INFO\" \n)\n\n#get your record by querying the metadata, e.g. by title, this will give you a list of all records with that title.\nmyrec <- zenodo$getDepositions(q='title:zen4R 2.0')\n\n#access the first item in the list, as there should only be one record with that particular title\nmyrec <- myrec[[1]]\n\n#edit data, delete_latest_files = TRUE deletes data of previous version,\nmyrec <- zenodo$depositRecordVersion(myrec, delete_latest_files = TRUE, files = \"path/to/your/new/file\", publish = TRUE)\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}