<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Reproducible Research with  and : Workflows for data, projects and publications – Reproducible Research with &lt;img style="vertical-align:middle; height:1em; border: none; background: none;" src="assets/images/Rlogo.png"&gt; and &lt;img style="vertical-align:middle; height:1em;" src="assets/images/quarto-logo-trademark.svg"&gt;</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="site_libs/quarto-contrib/iconify-2.1.0/iconify-icon.min.js"></script>
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9CCC34ZV10"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-9CCC34ZV10', { 'anonymize_ip': true});
</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<link href="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet">
<script src="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="site_libs/fontawesome-4.7.0/font-awesome.min.css" rel="stylesheet">


<link rel="stylesheet" href="index.css">
<meta property="og:title" content="Reproducible Research with  and : Workflows for data, projects and publications – Reproducible Research with  and ">
<meta property="og:description" content="A workshop presented at the Landscape 2024 conference, Berlin">
<meta property="og:site_name" content="Reproducible Research with <img style=&quot;vertical-align:middle; height:1em; border: none; background: none;&quot; src=&quot;assets/images/Rlogo.png&quot;> and <img style=&quot;vertical-align:middle; height:1em;&quot; src=&quot;assets/images/quarto-logo-trademark.svg&quot;>">
<meta name="twitter:title" content="Reproducible Research with  and : Workflows for data, projects and publications – Reproducible Research with  and ">
<meta name="twitter:description" content="A workshop presented at the Landscape 2024 conference, Berlin">
<meta name="twitter:image" content="https://blenback.github.io/R-for-Reproducible-Research/media/preview.png">
<meta name="twitter:creator" content="@Blen_Back">
<meta name="twitter:site" content="@Blen_Back">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Reproducible Research with <img style="vertical-align:middle; height:1em; border: none; background: none;" src="assets/images/Rlogo.png"> and <img style="vertical-align:middle; height:1em;" src="assets/images/quarto-logo-trademark.svg"></span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/blenback/R-for-Reproducible-Research">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/blenback/R-for-Reproducible-Research/issues">
            Report a Bug
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Reproducible Research with <img style="vertical-align:middle; height:35px; width: 35px; border: none; background: none;" src="assets/images/Rlogo.png"> and <img style="vertical-align:middle; height:35px; width: 140px;" src="assets/images/quarto-logo-trademark.svg">: Workflows for data, projects and publications</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./presentation.html" class="sidebar-item-text sidebar-link"><i class="bi bi-file-earmark-easel" role="img">
</i> 
 <span class="menu-text">View in presentation format</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#sec-background" id="toc-sec-background" class="nav-link active" data-scroll-target="#sec-background"><span class="header-section-number">1</span> Background</a>
  <ul class="collapse">
  <li><a href="#about-us" id="toc-about-us" class="nav-link" data-scroll-target="#about-us">About us</a></li>
  <li><a href="#what-is-reproducible-research" id="toc-what-is-reproducible-research" class="nav-link" data-scroll-target="#what-is-reproducible-research">What is reproducible research?</a></li>
  <li><a href="#why-strive-for-reproducible-research" id="toc-why-strive-for-reproducible-research" class="nav-link" data-scroll-target="#why-strive-for-reproducible-research">Why strive for reproducible research?</a></li>
  <li><a href="#why-for-reproducible-research" id="toc-why-for-reproducible-research" class="nav-link" data-scroll-target="#why-for-reproducible-research">Why <iconify-icon role="img" inline="" icon="fa-brands:r-project" aria-label="Icon r-project from fa-brands Iconify.design set." title="Icon r-project from fa-brands Iconify.design set."></iconify-icon> for reproducible research?</a></li>
  </ul></li>
  <li><a href="#sec-Rprojects" id="toc-sec-Rprojects" class="nav-link" data-scroll-target="#sec-Rprojects"><span class="header-section-number">2</span> Research projects with R</a>
  <ul class="collapse">
  <li><a href="#sec-projects" id="toc-sec-projects" class="nav-link" data-scroll-target="#sec-projects"><img src="assets/images/Rstudio.light.svg" style="vertical-align:middle; height:1.5em;"> projects</a></li>
  <li><a href="#sec-environment-management" id="toc-sec-environment-management" class="nav-link" data-scroll-target="#sec-environment-management">Environment management</a></li>
  <li><a href="#sec-writing-clean-code" id="toc-sec-writing-clean-code" class="nav-link" data-scroll-target="#sec-writing-clean-code">Writing clean code</a></li>
  <li><a href="#sec-workflow-decomposition" id="toc-sec-workflow-decomposition" class="nav-link" data-scroll-target="#sec-workflow-decomposition">Workflow decomposition</a></li>
  <li><a href="#sec-structuring" id="toc-sec-structuring" class="nav-link" data-scroll-target="#sec-structuring">Structuring your project directory</a></li>
  <li><a href="#sec-documentation" id="toc-sec-documentation" class="nav-link" data-scroll-target="#sec-documentation">Project documentation</a></li>
  </ul></li>
  <li><a href="#sec-workflows" id="toc-sec-workflows" class="nav-link" data-scroll-target="#sec-workflows"><span class="header-section-number">3</span> Workflows for Reproducibility</a>
  <ul class="collapse">
  <li><a href="#sec-zenodo_workflow" id="toc-sec-zenodo_workflow" class="nav-link" data-scroll-target="#sec-zenodo_workflow"><img src="assets/images/Rstudio.dark.svg" style="vertical-align:middle; height:1.5em;"> project to <img src="assets/images/Zenodo.light.svg" style="vertical-align:0%; height:0.85em;"> pipeline</a></li>
  <li><a href="#sec-docker_workflow" id="toc-sec-docker_workflow" class="nav-link" data-scroll-target="#sec-docker_workflow">Containerization with <img src="assets/images/Docker.light.svg" style="vertical-align:0%; height:1.25em;"></a></li>
  <li><a href="#sec-git_workflow" id="toc-sec-git_workflow" class="nav-link" data-scroll-target="#sec-git_workflow">Version control with <img src="assets/images/Github.dark.svg" style="vertical-align:0%; height:0.75em;"></a></li>
  </ul></li>
  <li><a href="#sec-Quarto" id="toc-sec-Quarto" class="nav-link" data-scroll-target="#sec-Quarto"><span class="header-section-number">4</span> Quarto</a></li>
  <li><a href="#sec-exercises" id="toc-sec-exercises" class="nav-link" data-scroll-target="#sec-exercises"><span class="header-section-number">5</span> Guided excercises</a>
  <ul class="collapse">
  <li><a href="#sec-Rproj_zenodo_exercise" id="toc-sec-Rproj_zenodo_exercise" class="nav-link" data-scroll-target="#sec-Rproj_zenodo_exercise">RStudio Project to Zenodo exercise</a></li>
  <li><a href="#sec-docker_exercise" id="toc-sec-docker_exercise" class="nav-link" data-scroll-target="#sec-docker_exercise">Containerization with Docker exercise</a></li>
  <li><a href="#version-control-with-git-exercise" id="toc-version-control-with-git-exercise" class="nav-link" data-scroll-target="#version-control-with-git-exercise">Version control with Git exercise</a></li>
  <li><a href="#sec-Quarto_exercise" id="toc-sec-Quarto_exercise" class="nav-link" data-scroll-target="#sec-Quarto_exercise">Writing an academic paper with Quarto</a></li>
  <li><a href="#r-and-git" id="toc-r-and-git" class="nav-link" data-scroll-target="#r-and-git">R and Git</a></li>
  <li><a href="#quarto-11" id="toc-quarto-11" class="nav-link" data-scroll-target="#quarto-11">Quarto</a></li>
  <li><a href="#zenodo" id="toc-zenodo" class="nav-link" data-scroll-target="#zenodo">Zenodo</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Reproducible Research with <img style="vertical-align:middle; height:35px; width: 35px; border: none; background: none;" src="assets/images/Rlogo.png"> and <img style="vertical-align:middle; height:35px; width: 140px;" src="assets/images/quarto-logo-trademark.svg">: Workflows for data, projects and publications</h1>
<p class="subtitle lead">A workshop presented at the <a href="https://landscape2024.org/frontend/index.php?folder_id=7393&amp;page_id=">Landscape 2024 conference</a>, Berlin</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/graphical_abstract_dark.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="assets/images/graphical_abstract_dark.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<p>This image highlights some the key concepts we will discuss in the workshop, which have been divided into seperate sections:</p>
<ol type="1">
<li><p><a href="@sec-background">Background</a>: Some introductory information on why reproducible and transparent research is important.</p></li>
<li><p><a href="@sec-Rprojects">Research projects with R</a>: Starting from the basics to develop good practice for creating research projects with R, focusing on some features of Rstudio as an Integrated Development Environment that can help ensure your work is reproducible.</p></li>
<li><p><a href="@sec-workflows">Workflows for reproducibility</a>: Here we present three workflows of differing levels of complexity and discusses how they can be combined and which might be best given the research needs.</p></li>
<li><p><a href="@sec-Quarto">Quarto</a>: Here we introduce the open-source scientific and technical publishing system Quarto which can be used for numerous academic activities including preparing manuscripts.</p></li>
<li><p><a href="@sec-exercises">Guided exercises</a>: Now it’s time to get hands-on with some guided exercises to put into practice some of the concepts we have discussed.</p></li>
</ol>
<!-- 6.  [Resources](@sec-resources): A collection of resources that we find particularly helpful in our own journey towards reproducible research. -->
<section id="sec-background" class="level1 page-columns page-full" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Background</h1>
<!-- Web content -->
<section id="about-us" class="level2">
<h2 class="anchored" data-anchor-id="about-us">About us</h2>
<p>We are four researchers from the research group <a href="https://plus.ethz.ch/">Planning of Landscape and Urban Systems (PLUS)</a> at <a href="https://ethz.ch/en.html">ETH Zürich</a>. Click on the social icons below our pictures to find out more about our individual research or get in touch with us.</p>
<div class="grid" style="display: flex; text-align: center;">
<div class="g-col-6">
<p><a href="assets/images/Ben.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="assets/images/Ben.jpg" class="picture img-fluid"></a></p>
<section id="ben-black" class="level3">
<h3 class="anchored" data-anchor-id="ben-black">Ben Black</h3>
<p><em>Doctoral Researcher</em></p>
<p><a href="https://blenback.github.io/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:house-chimney-user" style="font-size: 1.5em;" aria-label="Icon house-chimney-user from fa6-solid Iconify.design set." title="Icon house-chimney-user from fa6-solid Iconify.design set."></iconify-icon></a> <a href="mailto:bblack@ethz.ch" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:envelope" style="font-size: 1.5em;" aria-label="Icon envelope from fa6-solid Iconify.design set." title="Icon envelope from fa6-solid Iconify.design set."></iconify-icon></a> <a href="https://www.linkedin.com/in/ben-black-9889a1150/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:linkedin" style="font-size: 1.5em;" aria-label="Icon linkedin from fa6-brands Iconify.design set." title="Icon linkedin from fa6-brands Iconify.design set."></iconify-icon></a> <a href="https://github.com/blenback/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:github" style="font-size: 1.5em;" aria-label="Icon github from fa6-brands Iconify.design set." title="Icon github from fa6-brands Iconify.design set."></iconify-icon></a> <a href="https://www.researchgate.net/profile/Benjamin-Black-5/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:researchgate" style="font-size: 1.5em;" aria-label="Icon researchgate from fa6-brands Iconify.design set." title="Icon researchgate from fa6-brands Iconify.design set."></iconify-icon></a></p>
</section>
</div>
<div class="g-col-6">
<p><a href="assets/images/nivedita.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="assets/images/nivedita.jpg" class="picture img-fluid"></a></p>
<section id="nivedita-harisena" class="level3">
<h3 class="anchored" data-anchor-id="nivedita-harisena">Nivedita Harisena</h3>
<p><em>Doctoral Researcher</em></p>
<p><a href="https://irl.ethz.ch/people/person-detail.Mjg5Mjgx.TGlzdC8zNzc5LC0xMzk1OTgzMDM3.html" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:house-chimney-user" style="font-size: 1.5em;" aria-label="Icon house-chimney-user from fa6-solid Iconify.design set." title="Icon house-chimney-user from fa6-solid Iconify.design set."></iconify-icon></a> <a href="mailto:nharisena@ethz.ch" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:envelope" style="font-size: 1.5em;" aria-label="Icon envelope from fa6-solid Iconify.design set." title="Icon envelope from fa6-solid Iconify.design set."></iconify-icon></a> <a href="https://www.linkedin.com/in/nivedita-varma-harisena-667298141/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:linkedin" style="font-size: 1.5em;" aria-label="Icon linkedin from fa6-brands Iconify.design set." title="Icon linkedin from fa6-brands Iconify.design set."></iconify-icon></a> <a href="https://github.com/NVHarisena1" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:github" style="font-size: 1.5em;" aria-label="Icon github from fa6-brands Iconify.design set." title="Icon github from fa6-brands Iconify.design set."></iconify-icon></a></p>
</section>
</div>
<div class="g-col-6">
<p><a href="assets/images/Manuel.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="assets/images/Manuel.jpg" class="picture img-fluid"></a></p>
<section id="manuel-kurmann" class="level3">
<h3 class="anchored" data-anchor-id="manuel-kurmann">Manuel Kurmann</h3>
<p><em>Research Assistant</em></p>
<p><a href="https://irl.ethz.ch/people/person-detail.MjM2NjYz.TGlzdC8zNzc5LC0xMzk1OTgzMDM3.html" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:house-chimney-user" style="font-size: 1.5em;" aria-label="Icon house-chimney-user from fa6-solid Iconify.design set." title="Icon house-chimney-user from fa6-solid Iconify.design set."></iconify-icon></a> <a href="mailto:mankurma@student.ethz.ch" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:envelope" style="font-size: 1.5em;" aria-label="Icon envelope from fa6-solid Iconify.design set." title="Icon envelope from fa6-solid Iconify.design set."></iconify-icon></a> <a href="https://www.linkedin.com/in/manuel-kurmann-696577251/" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:linkedin" style="font-size: 1.5em;" aria-label="Icon linkedin from fa6-brands Iconify.design set." title="Icon linkedin from fa6-brands Iconify.design set."></iconify-icon></a> <a href="https://github.com/ManuelKurmann" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:github" style="font-size: 1.5em;" aria-label="Icon github from fa6-brands Iconify.design set." title="Icon github from fa6-brands Iconify.design set."></iconify-icon></a></p>
</section>
</div>
<div class="g-col-6">
<p><a href="assets/images/Maarten.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="assets/images/Maarten.jpg" class="picture img-fluid"></a></p>
<section id="maarten-van-strien" class="level3">
<h3 class="anchored" data-anchor-id="maarten-van-strien">Maarten Van Strien</h3>
<p><em>Senior scientist</em></p>
<p><a href="https://irl.ethz.ch/people/person-detail.MTYzODAz.TGlzdC8xNzM4LC0xMzk1OTgzMDM3.html" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:house-chimney-user" style="font-size: 1.5em;" aria-label="Icon house-chimney-user from fa6-solid Iconify.design set." title="Icon house-chimney-user from fa6-solid Iconify.design set."></iconify-icon></a> <a href="mailto:vanstrien@ethz.ch" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-solid:envelope" style="font-size: 1.5em;" aria-label="Icon envelope from fa6-solid Iconify.design set." title="Icon envelope from fa6-solid Iconify.design set."></iconify-icon></a> <a href="https://www.linkedin.com/in/maarten-van-strien-347b6747/?originalSubdomain=ch" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:linkedin" style="font-size: 1.5em;" aria-label="Icon linkedin from fa6-brands Iconify.design set." title="Icon linkedin from fa6-brands Iconify.design set."></iconify-icon></a> <a href="https://www.researchgate.net/profile/Maarten-Van-Strien" class="iconify-icon"><iconify-icon role="img" inline="" icon="fa6-brands:researchgate" style="font-size: 1.5em;" aria-label="Icon researchgate from fa6-brands Iconify.design set." title="Icon researchgate from fa6-brands Iconify.design set."></iconify-icon></a></p>
</section>
</div>
</div>
</section>
<section id="what-is-reproducible-research" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="what-is-reproducible-research">What is reproducible research?</h2>
<p>Reproducibility is a key aspect of reliable scientific research. It enables other researchers to reproduce the same results using the original data, code, and documentation <span class="citation" data-cites="essawy2020">[<a href="#ref-essawy2020" role="doc-biblioref">1</a>]</span>. Below are the core principles to ensure reproducibility in research:</p>
<div class="no-row-height column-margin column-container"><div id="ref-essawy2020" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Essawy BT, Goodall JL, Voce D, et al (2020) A taxonomy for reproducible and replicable research in environmental modelling. Environmental Modelling &amp; Software 134:104753. <a href="https://doi.org/10.1016/j.envsoft.2020.104753">https://doi.org/10.1016/j.envsoft.2020.104753</a></div>
</div></div><p><strong>Starts with planning</strong></p>
<p>Reproducibility begins during the planning stage. It is essential to organize data management and ensure clear protocols are in place even before starting the analysis. Consistent Data Storage Regular backups of data are crucial. Storing data in multiple locations ensures accessibility and minimizes the risk of data loss. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Contains clear documentation</strong></p>
<p>Thorough documentation is essential to guarantee that data and methods can be accurately interpreted and reproduced by others. This entails the use of well-organised files and the inclusion of metadata that describes the data, how it was obtained, and how it was processed. [<span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span>]<span class="citation" data-cites="siraji2023">[<a href="#ref-siraji2023" role="doc-biblioref">3</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Utilizes version control</strong></p>
<p>Using version control systems helps track changes in the project over time. This approach preserves the history of the project and facilitates the reversion of files to a previous state in the event of an error. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Is accessible</strong></p>
<p>Data should be stored in nonproprietary, portable formats to ensure broad accessibility and long-term usability. This practice ensures that researchers can access the data without relying on specific software tools. Making data and code publicly available in accessible repositories supports scientific transparency and allows broader use of research outputs. [<span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span>]<span class="citation" data-cites="siraji2023">[<a href="#ref-siraji2023" role="doc-biblioref">3</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p>By following these steps, researchers contribute to the wider scientific community, ensuring that their work can be efficiently and accurately reproduced by others.</p>
<p><strong>Introducing the FAIR Principles</strong></p>
<p>While the principles above lay the groundwork for reproducibility, the FAIR principles (Findability, Accessibility, Interoperability, and Reusability) provide a more comprehensive framework for enhancing the value of research data in the digital age. These principles expand on reproducibility by emphasizing not only human access to research outputs but also machine actionability, ensuring that data can be effectively found, accessed, and reused by both people and computational tools​. <span class="citation" data-cites="wilkinson2016">[<a href="#ref-wilkinson2016" role="doc-biblioref">4</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>How FAIR Principles Build on Reproducibility</strong></p>
<p>The FAIR principles naturally complement and expand on the core aspects of reproducible research:</p>
<ul>
<li><p>Findability reinforces the importance of clear documentation. Assigning persistent identifiers and providing rich metadata makes it easier for researchers and search tools to locate and understand datasets, ensuring that your research remains accessible over time.</p></li>
<li><p>Accessibility builds on the concept of using nonproprietary formats. FAIR emphasizes that data should be retrievable using open, standardized protocols, which ensures long-term access to both the data and its metadata, even if the data itself becomes unavailable.</p></li>
<li><p>Interoperability relates to the consistent use of data standards and version control. By using standardized formats and vocabularies, research data can be more easily integrated with other datasets, supporting reuse and long-term relevance in broader research contexts.</p></li>
<li><p>Reusability directly aligns with the goals of reproducible research by ensuring that data is accompanied by clear licensing and provenance, allowing others to confidently reuse it. This principle reinforces the need for thorough documentation and transparent methods.</p></li>
</ul>
<p>By incorporating the FAIR principles, researchers ensure that their data not only meets the standards of reproducibility but is also optimized for long-term use and discovery. This fosters a research environment where data is more transparent, accessible, and impactful over time​. <span class="citation" data-cites="wilkinson2016">[<a href="#ref-wilkinson2016" role="doc-biblioref">4</a>]</span></p>
<div class="no-row-height column-margin column-container"></div></section>
<section id="why-strive-for-reproducible-research" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="why-strive-for-reproducible-research">Why strive for reproducible research?</h2>
<p>In recent years, various scientific disciplines have experienced what is known as a “replication crisis”. This crisis arises when researchers are unable to reproduce the headline results of key studies using the reported data and methods [<span class="citation" data-cites="moonesinghe2007">[<a href="#ref-moonesinghe2007" role="doc-biblioref">5</a>]</span>]<span class="citation" data-cites="collaboration2015">[<a href="#ref-collaboration2015" role="doc-biblioref">6</a>]</span> <span class="citation" data-cites="bohannon2015">[<a href="#ref-bohannon2015" role="doc-biblioref">7</a>]</span>. This lack of reproducibility undermines public trust in science, as it raises doubts about the validity of research findings.</p>
<div class="no-row-height column-margin column-container"><div id="ref-moonesinghe2007" class="csl-entry" role="listitem">
<div class="csl-left-margin">5. </div><div class="csl-right-inline">Moonesinghe R, Khoury MJ, Janssens ACJW (2007) Most <span>Published</span> <span>Research</span> <span>Findings</span> <span>Are</span> <span>False</span>—<span>But</span> a <span>Little</span> <span>Replication</span> <span>Goes</span> a <span>Long</span> <span>Way</span>. PLOS Medicine 4(2):1–4. <a href="https://doi.org/10.1371/journal.pmed.0040028">https://doi.org/10.1371/journal.pmed.0040028</a></div>
</div><div id="ref-collaboration2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">6. </div><div class="csl-right-inline">Collaboration OS (2015) Estimating the reproducibility of psychological science. Science 349(6251):aac4716. <a href="https://doi.org/10.1126/science.aac4716">https://doi.org/10.1126/science.aac4716</a></div>
</div><div id="ref-bohannon2015" class="csl-entry" role="listitem">
<div class="csl-left-margin">7. </div><div class="csl-right-inline">Bohannon J (2015) Many psychology papers fail replication test. Science 349(6251):910–911. <a href="https://doi.org/10.1126/science.349.6251.910">https://doi.org/10.1126/science.349.6251.910</a></div>
</div></div><section id="advantages-of-reproducibility-for-your-research" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="advantages-of-reproducibility-for-your-research">Advantages of Reproducibility for Your Research</h3>
<p><strong>Personal Reference</strong></p>
<p>Conducting reproducible research simplifies the process of remembering how and why specific analyses were performed. This makes it easier to explain your work to collaborators, supervisors, and reviewers, enhancing communication throughout your project. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Efficient</strong></p>
<p>Modifications Reproducible research enables you to quickly adjust analyses and figures when requested by supervisors, collaborators, or reviewers. This streamlined process can save substantial time during revisions. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Streamlined Future Projects</strong></p>
<p>By maintaining well-organized and reproducible systems, you can reuse code and organizational structures for future projects. This reduces the time and effort required for similar tasks in subsequent research. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Demonstrates Rigor and Transparency</strong></p>
<p>Reproducibility demonstrates scientific rigor and transparency. It allows others to verify your methods and results, improving the peer review process and reducing the risk of errors or accusations of misconduct. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Increases Impact and Citations</strong></p>
<p>Making your research reproducible can lead to higher citation rates <span class="citation" data-cites="piwowar2007">[<a href="#ref-piwowar2007" role="doc-biblioref">8</a>]</span> <span class="citation" data-cites="mckiernan2016">[<a href="#ref-mckiernan2016" role="doc-biblioref">9</a>]</span>. By sharing your code and data, you enable others to reuse your work, broadening its impact and increasing its relevance in the scientific community. <span class="citation" data-cites="whitlock2011">[<a href="#ref-whitlock2011" role="doc-biblioref">10</a>]</span> <span class="citation" data-cites="culina2018">[<a href="#ref-culina2018" role="doc-biblioref">11</a>]</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-piwowar2007" class="csl-entry" role="listitem">
<div class="csl-left-margin">8. </div><div class="csl-right-inline">Piwowar HA, Day RS, Fridsma DB (2007) Sharing <span>Detailed</span> <span>Research</span> <span>Data</span> <span>Is</span> <span>Associated</span> with <span>Increased</span> <span>Citation</span> <span>Rate</span>. PLOS ONE 2(3):1–5. <a href="https://doi.org/10.1371/journal.pone.0000308">https://doi.org/10.1371/journal.pone.0000308</a></div>
</div><div id="ref-mckiernan2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">9. </div><div class="csl-right-inline">McKiernan EC, Bourne PE, Brown CT, et al (2016) How open science helps researchers succeed. eLife 5:e16800. <a href="https://doi.org/10.7554/eLife.16800">https://doi.org/10.7554/eLife.16800</a></div>
</div><div id="ref-whitlock2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">10. </div><div class="csl-right-inline">Whitlock MC (2011) Data archiving in ecology and evolution: Best practices. Trends in Ecology &amp; Evolution 26(2):61–65. https://doi.org/<a href="https://doi.org/10.1016/j.tree.2010.11.006">https://doi.org/10.1016/j.tree.2010.11.006</a></div>
</div><div id="ref-culina2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">11. </div><div class="csl-right-inline">Culina A, Crowther TW, Ramakers JJC, Gienapp P, Visser ME (2018) How to do meta-analysis of open datasets. Nature Ecology &amp; Evolution 2(7):1053–1056. <a href="https://doi.org/10.1038/s41559-018-0579-2">https://doi.org/10.1038/s41559-018-0579-2</a></div>
</div></div></section>
<section id="advantages-of-reproducibility-for-other-researchers" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="advantages-of-reproducibility-for-other-researchers">Advantages of Reproducibility for Other Researchers</h3>
<p><strong>Facilitates Learning</strong></p>
<p>Sharing data and code helps others learn from your work more easily. New researchers can use your data and code as a reference, speeding up their learning curve and improving the quality of their analyses. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Enables Reproducibility</strong></p>
<p>Reproducible research makes it simpler for others to reproduce and build upon your work, fostering more compatible and robust research across studies. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Error Detection</strong></p>
<p>By allowing others to access and review your data and code, reproducibility helps detect and correct errors, ensuring that mistakes are caught early and reducing the chance of their propagation in future research. <span class="citation" data-cites="alston2021">[<a href="#ref-alston2021" role="doc-biblioref">2</a>]</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-alston2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">2. </div><div class="csl-right-inline">Alston JM, Rick JA (2021) A <span>Beginner</span>’s <span>Guide</span> to <span>Conducting</span> <span>Reproducible</span> <span>Research</span>. The Bulletin of the Ecological Society of America 102(2):e01801. <a href="https://doi.org/10.1002/bes2.1801">https://doi.org/10.1002/bes2.1801</a></div>
</div></div></section>
</section>
<section id="why-for-reproducible-research" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="why-for-reproducible-research">Why <iconify-icon role="img" inline="" icon="fa-brands:r-project" aria-label="Icon r-project from fa-brands Iconify.design set." title="Icon r-project from fa-brands Iconify.design set."></iconify-icon> for reproducible research?</h2>
<p>R is increasingly recognized as a powerful tool for ensuring reproducibility in scientific research. Here are some key advantages of using R for reproducible research:</p>
<p><strong>Open Source</strong></p>
<p>Accessibility R is freely available to everyone, eliminating cost barriers and promoting inclusive access to research tools. This open-source model ensures that researchers around the world can use and contribute to its development, fostering a collaborative research environment. <span class="citation" data-cites="siraji2023">[<a href="#ref-siraji2023" role="doc-biblioref">3</a>]</span></p>
<div class="no-row-height column-margin column-container"></div><p><strong>Comprehensive Documentation</strong></p>
<p>R encourages thorough documentation of the entire research process. This ensures that analyses are well-tracked and can be easily replicated across different projects, enhancing the overall transparency and reliability of the research.</p>
<p><strong>Integrated Version Control</strong></p>
<p>R seamlessly integrates with version control systems like Git, allowing researchers to track changes to code, data, and documents. This helps maintain a detailed record of a project’s evolution and ensures that all steps are easily reproducible. <span class="citation" data-cites="siraji2023">[<a href="#ref-siraji2023" role="doc-biblioref">3</a>]</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-siraji2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">3. </div><div class="csl-right-inline">Siraji MA, Rahman M (2023) Primer on <span>Reproducible</span> <span>Research</span> in <span>R</span>: <span>Enhancing</span> <span>Transparency</span> and <span>Scientific</span> <span>Rigor</span>. Clocks &amp; sleep 6(1):1–10. <a href="https://doi.org/10.3390/clockssleep6010001">https://doi.org/10.3390/clockssleep6010001</a></div>
</div></div><p><strong>Consistency Across Platforms</strong></p>
<p>R provides a stable environment that works consistently across different operating systems, whether you are using Windows, Mac, or Linux. This cross-platform consistency greatly enhances the reproducibility of research across diverse systems.</p>
<p><strong>Broad Community Support</strong></p>
<p>The R community is large and active, continuously contributing to the improvement of the software. This broad support makes R a reliable choice for long-term research projects, ensuring that new tools and methods are constantly being developed and shared.</p>
<p><strong>Flexibility and Adaptability</strong></p>
<p>R offers a wide range of tools and functions that can be adapted to various research needs. This flexibility allows researchers to handle diverse tasks within a reproducible framework, making it a versatile tool for projects of all kinds.</p>
<!-- Presentation content -->
</section>
</section>
<section id="sec-Rprojects" class="level1 page-columns page-full" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Research projects with R</h1>
<!-- Web content -->
<p><strong>Let’s start with a definition of what makes a good R project from Jenny Bryan:</strong></p>
<p>A good R project… <em>“creates everything it needs, in its own workspace or folder, and it touches nothing it did not create.”</em> <span class="citation" data-cites="bryan2017">[<a href="#ref-bryan2017" role="doc-biblioref">12</a>]</span></p>
<div class="no-row-height column-margin column-container"><div id="ref-bryan2017" class="csl-entry" role="listitem">
<div class="csl-left-margin">12. </div><div class="csl-right-inline">Bryan J (2017) <a href="https://www.tidyverse.org/blog/2017/12/workflow-vs-script/">Project-oriented workflow</a></div>
</div></div><p>This is a good definition that contains concepts, such as the notion that projects should be ‘self-contained’. However we add one more caveat to this definition which is that a good R project should <em>explain itself</em>.</p>
<p>For the purpose of this workshop we will approach this topic by splitting it up into 6 topics which are highlighted in this graphic:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/project_components.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Graphical overview of components of a good research project in R"><img src="assets/images/project_components.png" class="img-fluid figure-img" alt="Graphical overview of components of a good research project in R"></a></p>
<figcaption>Graphical overview of components of a good research project in R</figcaption>
</figure>
</div>
<p>As you move through these you will see that there are areas of overlap and complementarity between them. These topics are also central to the choice of approaches in the <a href="@sec-workflows">three workflows for reproducibility</a> that we will share.</p>
<section id="sec-projects" class="level2">
<h2 class="anchored" data-anchor-id="sec-projects"><img src="assets/images/Rstudio.light.svg" style="vertical-align:middle; height:1.5em;"> projects</h2>
<p>How many times have you opened an R script and been greeted by this line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/ben/path/that/only/I/have"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While it is well-intentioned (i.e.&nbsp;avoiding the need to have full paths for all objects that will subsequently be loaded or daved ) the problem with it is obvious: This specific path is only relevant for the author and not other potential users and even for the author it will be invalid if they happen to change computers. The good news is there is a very simple way to avoid having to use <code>setwd()</code> at all by using <a href=""><strong>Rstudio Projects</strong></a>.</p>
<p>Rstudio projects designate new or existing folders as a defined working directory by creating an <code>.RProj</code> file within them. This means that when you open a project the working directory of the Rstudio session will automatically be set to the directory that the .RProj file is located in and the paths of all files in this folder will be relative to this.</p>
<p>The <code>.Rproj</code> file can be shared along with the rest of the research project files meaning that others users can easily open the Project to have the same working directory removing the need for those troublesome <code>setwd()</code> lines.</p>
<section id="sec-creating-projects" class="level3">
<h3 class="anchored" data-anchor-id="sec-creating-projects">Creating and opening projects</h3>
<p>Creating an Rstudio project is as simple as using <em>File &gt; New Project</em> in the top left and then choosing between creating the Project in a new or existing directory.</p>
<p>There are several ways to open a Project:</p>
<ol type="1">
<li>Using <em>File &gt; Open Project</em> in the top left of Rstudio.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/File_open_project.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="assets/images/File_open_project.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<ol start="2" type="1">
<li>Using the drop down menu in the top-right of the Rstudio session.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Open_project_right.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="assets/images/Open_project_right.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<ol start="3" type="1">
<li>Outside of R by double clicking on the <code>.Rproj</code> file in the folder.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Open_project_explorer.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="assets/images/Open_project_explorer.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</section>
<section id="sec-rprofile" class="level3">
<h3 class="anchored" data-anchor-id="sec-rprofile">Utilising project specific <code>.Rprofile</code>’s</h3>
<p>Another useful feature of Rstudio projects is the ability to store project-specific settings using the <code>.Rprofile</code> file which controls the initialisation behaviour of the R session when the project is opened. A useful application of this for reproducible research projects is automatically open a particular script, for example a master script that runs all the code in the project (which is a concept that will discussed under <a href="@sec-workflow-decomposition">workflow decomposition</a>).</p>
<p>To do this the contents of your <code>.Rprofile</code> file would like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setHook</span>(<span class="st">"rstudio.sessionInit"</span>, <span class="cf">function</span>(newSession) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (newSession)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Open the script specificed by the path</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    rstudioapi<span class="sc">::</span><span class="fu">navigateToFile</span>(<span class="st">'scripts/script_to_open.R'</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>L, <span class="at">column =</span> <span class="sc">-</span><span class="dv">1</span>L)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}, <span class="at">action =</span> <span class="st">"append"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The easiest way to create and edit <code>.Rprofile</code> files is to use the functions from the package <a href="https://usethis.r-lib.org/"><code>usethis</code></a>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the use of scope = "project" to create a project specific .Rprofile</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">edit_r_profile</span>(<span class="at">scope =</span> <span class="st">"project"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="sec-environment-management" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-environment-management">Environment management</h2>
<p>These lines of code are also probably familiar from the beginning of many an R script:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But what is wrong with these lines?</p>
<p>Well firstly, there is no indication of what version of the package is to be installed and hence if the code installing this package is old it may not work with the most recent version of the package (This is less of a problem for well established packages like the Tidyverse but for less common packages, that may see large changes between versions, it could be substantial).</p>
<p>Secondly, having the user install an unspecified version of a package could also cause dependency conflicts with other packages required by the code. This is because almost all packages have some form of dependency (i.e.&nbsp;they use the functionality of) on other packages. This is shown aptly by the image below which, while out-dated now, showed that in 2014 to install the 7 most popular R packages at the time would actually install 63 packages in total when considering their dependencies.</p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/package_dependencies_2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Package dependencies of popular R package [@devries2014]"><img src="assets/images/package_dependencies_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%" alt="Package dependencies of popular R package [13]"></a></p>
</figure>
</div>
<figcaption>Package dependencies of popular R package <span class="citation" data-cites="devries2014">[<a href="#ref-devries2014" role="doc-biblioref">13</a>]</span></figcaption>
<div class="no-row-height column-margin column-container"><div id="ref-devries2014" class="csl-entry" role="listitem">
<div class="csl-left-margin">13. </div><div class="csl-right-inline">Vries A de (2014) <a href="https://blog.revolutionanalytics.com/2014/07/revisiting-package-dependencies.html">Revisiting package dependencies</a></div>
</div></div></figure>
</div>
<p>However the problem is bigger than just packages because when your code runs it is also utilising:</p>
<ul>
<li><p>A specific version of R</p></li>
<li><p>A specific operating system</p></li>
<li><p>Specific versions of system dependencies, i.e.&nbsp;other software in other languages that R packages themselves utilise e.g GDAL for spatial analysis packages like <code>terra</code>.</p></li>
</ul>
<p>All of these things together make up what is known as the ‘environment’ of your code. Hence the process of documenting and managing this environment to is ensure that your code is reproducible (i.e.&nbsp;it not only runs but also consistently produces the same results).</p>
<p>There are different approaches to environment management that differ in their complexity and hence maybe suited to some projects and not others. For the purpose of this workshop we will focus on what we have found is one of the most user-friendly ways to manage your <em>package environment</em> (caveat that will be discussed) in R which is the package <code>renv</code>. Below we will introduce this package in more detail as it will form a central part of the <a href="@sec-workflows">three workflows for reproducibility</a> that we present.</p>
<section id="creating-reproducible-environments-with-renv" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="creating-reproducible-environments-with-renv">Creating reproducible environments with <code>renv</code></h3>
<p>As mentioned above <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code></a> is an R package that helps you create reproducible environments for your R projects by not only documenting your package environment but also providing functionality to re-create it.</p>
<p>It does this by creating <strong>project specific libraries</strong> (i.e.&nbsp;directories: <code>renv/library</code>) which contain all the packages used by your project. This is different from the default approach to package usage and installation whereby all packages are stored in a single library on your machine (system library). Having separate project libraries means “that different projects can use different versions of packages and installing, updating, or removing packages in one project doesn’t affect any other project.” <span class="citation" data-cites="renv">[<a href="#ref-renv" role="doc-biblioref">14</a>]</span>. In order to make sure that your project uses the project library everytime it is opened <code>renv</code> utilises the functionality of <a href="@sec-rprofile"><code>.Rprofile's</code></a> to set the project library as the default library.</p>
<div class="no-row-height column-margin column-container"><div id="ref-renv" class="csl-entry" role="listitem">
<div class="csl-left-margin">14. </div><div class="csl-right-inline">Ushey K, Wickham H (2024) <a href="https://CRAN.R-project.org/package=renv">Renv: Project environments</a></div>
</div></div><p>Another key process of renv is to create project specific <strong>lockfiles</strong> (<code>renv.lock</code>) which contain sufficient metadata about each package in the project library so that it can be re-installed on a new machine.</p>
<p>As alluded to, renv does a great job of managing your packages but is not intended to manage other aspects of your environment such as: tracking your version of R or your operating system. This is why if you want ‘bullet-proof’ reproducibility renv needs to be used alongside other approaches such as containerization which is the <a href="@sec-docker_workflow">3rd and most complex workflow</a> we will discuss.</p>
</section>
</section>
<section id="sec-writing-clean-code" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-writing-clean-code">Writing clean code</h2>
<p>The notion of writing ‘clean’ code can be daunting, especially for those new to programming. However, the most important thing to bear in mind is that there is no objective measure that makes code ‘clean’ vs.&nbsp;‘un-clean’, rather we should of think ‘clean’ coding as the pursuit of making your code easier to read, understand and maintain. Also while we should aspire to writing clean code, it is arguably more important that it functions correctly and efficiently.</p>
<p>The central concept of clean coding is that, like normal writing, we should follow a set of rules and conventions. For example, in English a sentence should start with a capital letter and end with a full stop. Unfortunately, in terms of writing R code there is not a single set of conventions that everyone proscribes to, instead there are numerous styles that have been outlined and the important thing is to choose a style and apply it consistently in your coding.</p>
<p>Perhaps the two most common styles are the <a href="https://style.tidyverse.org/">Tidyverse style</a> and the <a href="https://google.github.io/styleguide/Rguide.html">Google R style</a> (Which is actually a derivative of the former). Neither style can be said to be the more correct, rather they express opinionated preferences on a series of common topics such as: Object naming, use of assignment operators, spacing, indentation, line length, parentheses placement, etc.</p>
<p>Rather than detail all of these topics here we will focus on just on some related tips that we think are most relevant for scientific research coding, including how to automate the formatting of your code to a particular style. However, we encourage you to go through the different style guides when you have the time.</p>
<section id="sec-script_headers" class="level3">
<h3 class="anchored" data-anchor-id="sec-script_headers">Script headers</h3>
<p>Starting your scripts with a consistent header containing information about it’s purpose, author/s, creation and modification dates is a great step making your workflow more understandable and hopefully reproducible. There are no rules as to what such a header should look like but this is the style I like to use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Script_title: Brief description of script purpose</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Notes: More detailed notes about the script and it's purpose</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Date created: </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Author(s):</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To save time inserting this header into new scripts you use Rstudio’s <a href="https://docs.posit.co/ide/user/ide/guide/productivity/snippets.html"><strong>Code snippets</strong></a> feature. Code snippets are simply text macros that quickly insert a section of code using a short keyword.</p>
<p>To create your own Code snippet go to <em>Tools &gt; Global Options &gt; Code &gt; Edit Snippets</em> and then add a new snippet with your code below it:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Code_snippet_add.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="assets/images/Code_snippet_add.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<p>To use a code snippet simply start typing the keyword in the script and the auto-completion list will appear then press <code>Tab</code> and the code section will be inserted:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Code_snippet_completion.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="assets/images/Code_snippet_completion.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</section>
<section id="sec-code_sections" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="sec-code_sections">Code sections</h3>
<p>As you may already know braced (<code>{}</code>) sections of code (i.e.&nbsp;function definitions, conditional blocks, etc.) can be folded to hide their contents in RStudio by clicking on the small triangle in the left margin.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/code_section_sequential.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="assets/images/code_section_sequential.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
<p>However, an often overlooked feature is the ability to create named code sections that can be also folded, as well as easily navigated between. These can be used to break longer scripts into a set of discrete regions according to specific parts of the analysis (<a href="@sec-workflow-decomposition">discussed in more detail later</a>). In this regard, another good tip is to give the resulting sections sequential alphabetical or numerical Pre-fixes. Code sections are created by inserting a comment line that contains at least four trailing dashes (<code>-</code>), equal signs (<code>=</code>), or pound signs (<code>#</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Section One ---------------------------------</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Section Two =================================</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Section Three #############################</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively you can use the <em>Code &gt; Insert Section</em> command.</p>
<p>To navigate between code sections:</p>
<ul>
<li>Use the <strong>Jump To</strong> menu available at the bottom of the editor<span class="citation" data-cites="positsupport2024">[<a href="#ref-positsupport2024" role="doc-biblioref">15</a>]</span></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="ref-positsupport2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">15. </div><div class="csl-right-inline">Posit Support (2024) <a href="https://support.posit.co/hc/en-us/articles/200484568-Code-Folding-and-Sections-in-the-RStudio-IDE">Code folding and sections in the RStudio IDE</a></div>
</div></div><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/code_section_jumpto.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="assets/images/code_section_jumpto.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<ul>
<li>Use the document outline pane in the top right corner of the source pane</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/code_section_documentpane.light.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="assets/images/code_section_documentpane.light.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
</section>
<section id="automating-the-styling-of-your-code" class="level3">
<h3 class="anchored" data-anchor-id="automating-the-styling-of-your-code">Automating the styling of your code</h3>
<p>There are two R packages that are very helpful in terms of ensuring your code confirms to a consistent style: <a href="https://lintr.r-lib.org/"><code>lintr</code></a> and <a href="https://styler.r-lib.org/"><code>styler</code></a>.</p>
<ul>
<li><code>lintr</code> checks your code for common style issues and potential programming errors then presents them to you to correct, think of it like doing a ‘spellcheck’ on a written document.</li>
<li><code>styler</code> is more <em>active</em> in the sense that it automatically format’s your code to a particular style, the default of which is the tidyverse style.</li>
</ul>
<p>To use lintr and styler you call their functions like any package but styler can also be used through the <strong>Rstudio Addins</strong> menu below the Navigation bar as shown in this gif:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://raw.githubusercontent.com/lorenzwalthert/some_raw_data/master/styler_0.1.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="https://raw.githubusercontent.com/lorenzwalthert/some_raw_data/master/styler_0.1.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<p>Another very useful feature of both packages is that they can be used as part of a continuous integration (CI) workflow using a version control application like Git. This is a topic that we will cover as part of our <a href="@sec-git_workflow">Version control with Git</a> workflow but what it means is that the styler and lintr functions are run automatically when you push your code to a remote repository.</p>
</section>
</section>
<section id="sec-workflow-decomposition" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-workflow-decomposition">Workflow decomposition</h2>
<p>In computer sciences workflow decomposition refers to the structuring or compartmentalising of your code into seperate logical parts that makes it easier to maintain <span class="citation" data-cites="decompos2024">[<a href="#ref-decompos2024" role="doc-biblioref">16</a>]</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-decompos2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">16. </div><div class="csl-right-inline">(2024) <a href="https://en.wikipedia.org/w/index.php?title=Decomposition_(computer_science)&amp;oldid=1225228761">Decomposition (computer science)</a></div>
</div></div><p>In terms of coding scientific research projects many of us probably already instinctively do decomposition to some degree by splitting typical processes such as data preparation, statistical modelling, analysis of results and producing final visualizations.</p>
<p>However this is not always realized in the most understandable way, for example we may have seperate scripts with logical sounding names like: <code>Data_prep.R</code> and <code>Data_analysis.R</code> but can others really be expected to know exactly which order these must be run in, or indeed whether they even need to be run sequentially at all?</p>
<p>A good 1st step to remedying this is to give your scripts sequential numeric tags in their names, e.g.&nbsp;<code>01_Data_prep.R</code>, <code>02_Data_analysis.R</code>. This will also ensure that they are presented in numerical order when placed in a designated directory <a href="@sec-structuring">Structuring your project directory</a> and can be explicitly described in your <a href="@sec-documentation">project documentation</a>.</p>
<p>But you can take this to the next level by creating a <em>Master</em> script that sources your other scripts in sequence (think of them as <em>sub-scripts</em>) so that users of your code need only run one script. To do this is as simple as creating the master script as you would any normal R script (<em>File &gt; New File &gt; R script</em>) and then using the <code>base::source()</code> function to run the sub-scripts:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Master_script: Run steps of research project in order</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Date created: 30/7/2024</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Author(s): Jane Doe</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">### A- Prepare dependent variable data</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Prepare LULC data</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Scripts/Preparation/Dep_var_dat_prep.R"</span>, <span class="at">local =</span> scripting_env)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">### B- Prepare independent variable data</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Prepare predictor data</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Scripts/Preparation/Ind_var_data_prep.R"</span>, <span class="at">local =</span> scripting_env)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">### C- Perform statisical modelling</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Scripts/Modelling/Fit_stat_models.R"</span>, <span class="at">local =</span> scripting_env)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As you can see in this example code I have also made use of a <a href="@sec-script_headers">script header</a> and <a href="@sec-code_sections">code sections</a>, that were previously discussed, to make the division of sub-processes even clearer. Another advantage of this approach is that all sub-scripts can utilise the same environment (defined by the <code>source(local= )</code> argument) which means that each individual script does not need to load packages or paths as objects.</p>
<p>Finally, within your sub-scripts processes should also be seperated into code sections and ideally any repetitive tasks should be performed with custom functions which again are contained within their own files.</p>
<p>Following this approach you end up with a workflow that will look something like this:</p>
<p><a href="assets/images/workflow_decomposition.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="assets/images/workflow_decomposition.png" class="img-fluid" style="width:100.0%"></a></p>
<p>The benefit of this hierarchical approach to structuring is that it is not only easier to debug and maintain individual processes but it is also more amenable to adding new processes.</p>
</section>
<section id="sec-structuring" class="level2">
<h2 class="anchored" data-anchor-id="sec-structuring">Structuring your project directory</h2>
<p>Similar to having clean code, having a clean project directory that has well-organised sub-directories goes a long way towards making your projects code easier to understand for others. For software development there are numerous sets of conventions for directories structures although these are not always so applicable for scientific research projects. However we can borrow some basic principles, try to use: - Use logical naming - Stick to a consistent style, i.e.&nbsp;use of captialisation and seperators - Make use of nested sub-directories e.g <code>data/raw/climatic/precipitation/2020/precip_2020.rds</code> vs.&nbsp;<code>data/precip_2020_raw.rds</code>. This is very helpful when it comes to programatically constructing file paths especially in projects with a lot of data.</p>
<p>As an example my go-to project directory structure looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>└── my_project</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    ├── data <span class="co"># The research data</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    │   ├── raw</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    │   └── processed</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    ├── output <span class="co"># Storing results</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    ├── publication <span class="co"># Containing the academic manuscript of the project</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    ├── src <span class="co"># For all files that perform operations in the project</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    │   ├── scripts</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    │   └── functions</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    └── tools <span class="co"># Auxilliary files and settings</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Rather than manually create this directory structure everytime you start a new project, save yourself some time and automate it by using Rstudio’s <a href="https://docs.posit.co/ide/user/ide/guide/productivity/project-templates.html"><strong>Project Templates</strong></a> functionality. This allows you to select a custom template as an option when creating a new <a href="@sec-creating-projects">Rstudio project</a> through the New project wizard (<em>File &gt; New Project &gt; New Directory &gt; New Project Template</em>).</p>
<p>To implement this even as an intermediate R user is fairly labor intensive as your custom project directory template needs to be contained within an R-package, in order to be available in the wizard. However, quite a few templates with directory structures appropriate for scientific research projects have been created by others:</p>
<ul>
<li><p><a href="https://github.com/benmarwick/rrtools"><code>rrtools</code></a></p></li>
<li><p><a href="http://projecttemplate.net/"><code>ProjectTemplate</code></a></p></li>
<li><p><a href="https://pakillo.github.io/template/"><code>template</code></a></p></li>
<li><p><a href="https://dreamrs.github.io/addinit/"><code>addinit</code></a> (Not a template but an interactive shiny add-in for project creation)</p></li>
</ul>
</section>
<section id="sec-documentation" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-documentation">Project documentation</h2>
<p>As an example of why documentation is important think about if you bought a new table from Ikea only to excitedly rip open the box and find that there are no instructions for how to assemble it. Sure, you know what a table is supposedly to look like and given enough time you will end up with something that will probably be mostly right but maybe it’s missing small details. Also it will probably take you just as long to take it apart in 5 years time. Well, working with undocumented code for research projects is similar except a lot more complicated!</p>
<p>Writing comprehensive documentation that covers all aspects of our projects is time-consuming which is why it is often neglected. For example, there are a lot of different metadata conventions that exist that you could apply. However, learning and adhering strictly to these can be overwhelming and possibly lead to the opposite effect i.e.&nbsp;they are not simple for others to understand either.</p>
<p>In response to this there has been a movement in the R research community to adopt the <em>research as package</em> approach, which, as the name suggests, involves creating your project as an R-package which has a strict set of conventions for documentation <span class="citation" data-cites="marwick2018">[<a href="#ref-marwick2018" role="doc-biblioref">17</a>]</span>. This is a viable approach for those who are familiar with R-packages but is arguably not the best for all projects and users.</p>
<div class="no-row-height column-margin column-container"><div id="ref-marwick2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">17. </div><div class="csl-right-inline">Marwick B, Boettiger C, Mullen L (2018) Packaging data analytical work reproducibly using r (and friends). The American Statistician 72(1):80–88. <a href="https://doi.org/10.1080/00031305.2017.1375986">https://doi.org/10.1080/00031305.2017.1375986</a></div>
</div></div><p>Instead, we would suggest to follow the maxim of <em>not letting the perfect be the enemy of the good</em> and to focus on these key areas:</p>
<ul>
<li><p><strong>Provide adequate in-script commentary</strong>: This is perhaps contentious for those from a software development community, but given the choice I would rather have to read through a script with too many comments than one with too few. However remember that comments should be used to explain the purpose of the code, not what the code is doing. In line with this use <a href="@sec-script_headers">script headers</a>.</p></li>
<li><p><strong>Document your functions with <code>roxygen</code> skeletons</strong>:</p></li>
<li><p><strong>Include a <code>README</code> file</strong>: README files are where you should document your project at the macro-level i.e.&nbsp;what it is about and how it is supposed to work.</p></li>
</ul>
<p>The latter of these two are more detailed so we have provided further information and tips in sections below.</p>
<section id="sec-roxygen" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="sec-roxygen">Function documentation with <code>roxygen2</code></h3>
<p>Base R provides a standard way of documenting a package where each function is documented in an <code>.Rd</code> file (R documentation). This documentation uses a custom syntax to detail key aspects of the functions such as their input parameters, outputs and any package dependencies <span class="citation" data-cites="wickham2024">[<a href="#ref-wickham2024" role="doc-biblioref">18</a>]</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-wickham2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">18. </div><div class="csl-right-inline">Wickham H, Bryan J (2024) <a href="https://r-pkgs.org/">R packages (2e)</a>, 2nd Edition</div>
</div></div><p>In the case of many research projects you will not be creating a package however it is still useful to apply this documentation style to your functions as it is a good way to make them understandable and easier to modify by others. For example, having clear information about the object (e.g.&nbsp;a vector or data.frame) that a function accepts, saves others time in guessing what the function is expecting if they are trying to use new data.</p>
<p>However, rather than manually writing <code>.Rd</code> files, we can use the <code>roxygen2</code> package to automatically generate these files from a block of comments that are added to the top of the function scripts. To add this comment block, place your cursor inside a function you want to document and press <code>Ctrl + Shift + R</code> (or <code>Cmd + Shift + R</code> on Mac) or you can go to <em>code tools &gt; insert roxygen skeleton</em> (code tools is represented by the wand icon in the top row of the source pane). As you can see in this gif below, when you insert the roxygen block it will already contain the names of the function, its arguments and any returns. You can then fill in the rest of the information, such as the description and dependencies etc. for a guide to these other fields see the <a href="https://roxygen2.r-lib.org/articles/rd.html">roxygen2 documentation</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://jozef.io/img/r102-01-add-roxy-skeleton.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Inserting roxygen block"><img src="https://jozef.io/img/r102-01-add-roxy-skeleton.gif" class="img-fluid figure-img" style="width:50.0%" alt="Inserting roxygen block"></a></p>
<figcaption>Inserting roxygen block</figcaption>
</figure>
</div>
</section>
<section id="tips-for-readme-writing" class="level3">
<h3 class="anchored" data-anchor-id="tips-for-readme-writing">Tips for README writing</h3>
<p>If you look at the source code of R packages or projects that use R in Github repositories you will see that they all contain <code>README.md</code> files. <code>.md</code> is <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> format which is the most common format for README files in R projects because it can be read by many programs and rendered in a variety of formats. These files are often accompanied by the corresponding file <code>README.Rmd</code> which generates the <code>README.md</code> file. In this sense writing the README for your project in markdown makes sense and there tools available to help you do this such as the <code>usethis</code> package which has a function <a href="https://usethis.r-lib.org/reference/use_readme_rmd.html"><code>use_readme_rmd()</code></a> that will create a <code>README.Rmd</code> file for you. However, depending on who you anticipate using your project you may also want to create your README as a raw text file (<code>.txt</code>) which may be a more familiar format for some users and again can be opened by many different programs.</p>
<p>Again there is not a single standardised format for what should be included in your README file but here is an example of a README file that was written for one of the authors code/data upload alongside a publication: <a href="assets/README_demo.txt">README.txt</a></p>
<p>You will see that one of the things this README includes is a tree diagram which shows the directory structure of the project right down to the file level. This is a useful way to give an overview of what users should find included in the project and then explanatory notes can be added to explain the purpose of each file or directory. Such a diagram can be easily generated using the <code>fs</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"fs"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#vector path of the target directory to make a file tree from</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>Target_dir <span class="ot">&lt;-</span> <span class="st">"YOUR DIR"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#produce tree diagram of directory sub-dirs and files and save output using capture.ouput from base R utils.</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">capture.output</span>(<span class="fu">dir_tree</span>(Target_dir), <span class="at">file=</span> <span class="st">'Dir_tree_output.txt'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Presentation content -->
</section>
</section>
</section>
<section id="sec-workflows" class="level1 page-columns page-full" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Workflows for Reproducibility</h1>
<p>For this workshop we will outline three different workflows for creating reproducible research projects with R combined with other tools. We have named these workflows as follows:</p>
<ol type="1">
<li><p><img src="assets/images/Rstudio.light.svg" style="vertical-align:middle; height:1em;"> to <img src="assets/images/Zenodo.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline</p></li>
<li><p>Containerization with <img src="assets/images/Docker.dark.svg" style="vertical-align:0%; height:1.25em;"></p></li>
<li><p>Version control with <img src="assets/images/Github.light.svg" style="vertical-align:0%; height:0.75em;"></p></li>
</ol>
<p>These workflows are inter-related in the sense that 2. and 3. build upon elements of the first and indeed the techniques of the latter workflows can also be combined together. The workflows differ in the level of reproducibility they ensure but the trade-off for better reproducibility is increased complexity. As such we would suggest that the most reproducible workflow may not always be the most appropriate to implement dependent on the needs of your research project and the capabilities of the collaborators involved.</p>
<p>Of course, these workflows are by no-means the only way of doing things and indeed we would actively encourage you to expand upon them in developing your own preferred approach.</p>
<section id="sec-zenodo_workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-zenodo_workflow"><img src="assets/images/Rstudio.dark.svg" style="vertical-align:middle; height:1.5em;"> project to <img src="assets/images/Zenodo.light.svg" style="vertical-align:0%; height:0.85em;"> pipeline</h2>
<!-- Web content -->
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/project_zenodo_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="assets/images/project_zenodo_workflow.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<p>The graphic above shows the main steps of this workflow. It starts by developing your research project as an Rstudio project following the <a href="@sec-Rprojects">good practice project guidelines</a> we have discussed. Then, it uses the <code>renv</code> package to manage the project environment so that others can re-create it. Finally, the code, data and environment are uploaded to the open-access repository <code>Zenodo</code>, which provides a DOI for your work, ensuring long-term accessibility and reproducibility.</p>
<p>The <code>renv</code> package helps maintain the R environment, allowing others to recreate the environment in which your analysis was conducted. By combining <code>renv</code> with Zenodo, you create a comprehensive solution for reproducible research. <code>renv</code> ensures that the computational environment is captured, while Zenodo makes your research outputs accessible and citable, supporting the FAIR principles of findability, accessibility, interoperability, and reusability <span class="citation" data-cites="wilkinson2016">[<a href="#ref-wilkinson2016" role="doc-biblioref">4</a>]</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-wilkinson2016" class="csl-entry" role="listitem">
<div class="csl-left-margin">4. </div><div class="csl-right-inline">Wilkinson MD, Dumontier M, Aalbersberg IjJ, et al (2016) The <span>FAIR</span> <span>Guiding</span> <span>Principles</span> for scientific data management and stewardship. Scientific Data 3(1):160018. <a href="https://doi.org/10.1038/sdata.2016.18">https://doi.org/10.1038/sdata.2016.18</a></div>
</div></div><p>The next sections provide some additional detail on <a href="@sec-renv_workflow">environment management with renv</a> and some background and practical tips on <a href="@sec-zenodo_background">Zenodo</a>. You will have the chance to apply this workflow to an example project in the <a href="@sec-Rproj_zenodo_exercise">accompanying exercise</a>.</p>
<section id="sec-renv_workflow" class="level3">
<h3 class="anchored" data-anchor-id="sec-renv_workflow">Environment Management with <code>renv</code></h3>
<p><code>renv</code> is a powerful R package designed to help manage project environments by creating project-specific libraries and lockfiles. As mentioned earlier, <code>renv</code> captures the exact versions of R packages used in a project, storing this information in a renv.lock file. This allows users to recreate the exact package environment when revisiting a project or transferring it to a different machine, ensuring reproducibility.</p>
<p>The <code>renv</code> workflow is straightforward:</p>
<ul>
<li><p><strong>Initialize <code>renv</code> in a project</strong>: <code>renv</code> creates a separate library in the project folder, isolating the packages from the system-wide library.</p></li>
<li><p><strong>Snapshot dependencies</strong>: <code>renv</code> scans the project, identifying which packages are being used and recording their versions in the lockfile.</p></li>
<li><p><strong>Restore environments</strong>: Anyone cloning or receiving the project can run <code>renv::restore()</code> to install the exact versions of the packages listed in the lockfile from the project library, reproducing the original project package environment.</p></li>
</ul>
<p>One of the core strengths of <code>renv</code> is its flexibility. It integrates seamlessly with tools like RStudio, allowing easy management of dependencies without disrupting existing workflows. This makes it particularly well-suited for ensuring that research projects are reproducible across different systems and platforms.</p>
<p>However, <code>renv</code> does not manage the <strong>entire system environment</strong> (such as the version of R itself or external dependencies like system libraries). For complete reproducibility, combining <code>renv</code> with</p>
<p>containerization tools (like <a href="@#sec-docker_workflow">Docker</a>) or publishing outputs (such as code or data) via repositories like Zenodo is recommended.</p>
</section>
<section id="sec-zenodo_background" class="level3">
<h3 class="anchored" data-anchor-id="sec-zenodo_background"><img src="assets/images/zenodo-blue.svg" style="vertical-align:middle; height:2.75em;"> as a research repository</h3>
<p><a href="https://zenodo.org/">Zenodo</a> is a platform created under the European Commission‘s <a href="https://www.openaire.eu/">OpenAIRE project</a> in partnership with <a href="https://home.cern/">CERN</a> to publish, archive, and share scientific research outputs, including datasets, code, and publications.</p>
<p>Of course there are many other similar research repositories, such as <a href="https://datadryad.org/stash">Dryad</a>, <a href="https://figshare.com/">Figshare</a>, <a href="https://data.mendeley.com/">Mendeley Data</a> and <a href="https://osf.io/q5j8g/">OSF</a>, but we recommend Zenodo for several reasons:</p>
<ul>
<li><p><strong>Generous upload size of 50GB (100 files) per record</strong></p></li>
<li><p><strong>Aligns with FAIR and Open Science principles</strong>: The practical features of Zenodo that ensure this are described in it‘s <a href="https://about.zenodo.org/principles/">principles</a></p></li>
<li><p><strong>Ability to create communities</strong>: <a href="https://help.zenodo.org/docs/communities/about-communities/">Zenodo Communities</a> are used to group similar records together. This is useful for creating a collection of related research outputs, either for a research group or a large-scale funded project.</p></li>
<li><p><strong>Long term preservation with assignment of DOIs:</strong> Each item published on Zenodo is assigned a permanent <a href="https://simple.wikipedia.org/wiki/Digital_Object_Identifier"><em>Digital Object Identifier</em> (DOI)</a>, which is a better way than a URL to cite the record in academic writing.</p></li>
<li><p><strong>Open source</strong>: This means that Zenodo is not just free to use but you can even see the <a href="https://github.com/zenodo/zenodo-rdm">code it is built on</a> and contribute to it.</p></li>
<li><p><strong>Versioning functionality:</strong> Every record starts with a 1st version and <a href="https://help.zenodo.org/docs/deposit/manage-versions/">new versions can be added as research is updated</a>, while earlier versions remain accessible. This is crucial in scientific research, where updated analyses and data corrections are often necessary, but also transparency around earlier versions of the work should be maintained.</p></li>
<li><p><strong>Integration with GitHub:</strong> When a research project (e.g., code) is hosted on <a href="@sec-git_workflow">GitHub</a>, Zenodo can be used to <a href="https://help.zenodo.org/docs/profile/linking-accounts/">archive the repository</a> upon each new release, creating a snapshot with a DOI. This means that a version of the code can be more easily cited in scientific publications.</p></li>
<li><p><strong>Application programming Interface (API) to access records programmatically:</strong> This a useful feature as it allows for interfacing with Zenodo records without using the website and is the backbone of the <code>zen4R</code> package that allows for publishing records directly from R which we discuss in more detail below.</p></li>
</ul>
</section>
<section id="publishing-to-zenodo-with-zen4r" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="publishing-to-zenodo-with-zen4r">Publishing to Zenodo with <code>zen4R</code></h3>
<p>The <a href="<https://cran.r-project.org/web/packages/zen4R"><code>zen4R</code></a> package <span class="citation" data-cites="blondel2024">[<a href="#ref-blondel2024" role="doc-biblioref">19</a>]</span> provides functions to interact with <code>Zenodo‘s</code> API directly from R. The package allows you to:</p>
<div class="no-row-height column-margin column-container"></div><ul>
<li><p>Retrieve the metadata of, and download, existing <code>Zenodo</code> records.</p></li>
<li><p>Create new records and versions of records, write their metadata and upload files to <code>Zenodo</code>.</p></li>
</ul>
<p>We will use <code>zen4R</code> to publish the code, data, and environment of our example project to <code>Zenodo</code> in the accompanying exercise.</p>
<!-- Presentation content -->
</section>
</section>
<section id="sec-docker_workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-docker_workflow">Containerization with <img src="assets/images/Docker.light.svg" style="vertical-align:0%; height:1.25em;"></h2>
<!-- Web content -->
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Docker_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="assets/images/Docker_workflow.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></a></p>
</figure>
</div>
<p><strong>The title of this workflow raises two questions, the first being: what is containerization? and the second: what is Docker?</strong> ### Containerisation</p>
<p>Simply put containerization is the process of bundling code along with all of it’s dependencies, i.e.&nbsp;all the components we discussed as making up the <a href="@sec-environment-management">environment</a>, including the operating system, software libraries (packages), and other system software. The fact everything needed to run the code is included means that the code is portable and can be run on any platform or cloud service. This also makes containerization something of a gold standard for reproducibility as the entire environment is explicitly re-produced.</p>
<section id="docker" class="level3">
<h3 class="anchored" data-anchor-id="docker">Docker</h3>
<p><a href="https://www.docker.com/">Docker</a> is an open-source, and the most popular, platform for containerization. Before we dive into a practical example using Docker for research projects with R it is important to introduce some three key terms that we will come across:</p>
<ul>
<li><p><code>Dockerfile</code>: The first step in the containerization process, they are a straightforward text file containing a collection of commands or procedures to create a new Docker Image. In this sense we can consider a Dockerfile are the source code of Docker Image. Importantly, Dockerfiles typically start from a base image, which is a existing Docker Image that your image is extending.</p></li>
<li><p><code>Docker Image</code>: A read-only file that contains the instructions for creating a Docker Container. Think of an image as the blueprint of what will be in a container when it is running. Docker Images can be shared via <a href="https://hub.docker.com/">Dockerhub</a>, so that they can be used by others.</p></li>
<li><p><code>Docker Container</code>: Is an actual running instance of a Docker image. It runs completely isolated from the host environment by default and only accesses host files (i.e.&nbsp;data) if it has been configured to do so. It is possible to create multiple containers simultaneously from the same Docker Image, and each container can be started, stopped, moved, and deleted independently of the others.</p></li>
</ul>
<p>The graphic above shows the relationships between these components including the central commands of Docker that connect them <code>build</code> and <code>run</code>.</p>
</section>
<section id="using-docker-with-r" class="level3">
<h3 class="anchored" data-anchor-id="using-docker-with-r">Using Docker with R</h3>
<p>So to create a <code>Docker Image</code> to containerize our R research projects we need to start by creating a <code>Dockerfile</code> and, as mentioned above, this should start with a base image. In our case this base image must logically include R and RStudio (if we want to utilise the RStudio Projects features).</p>
<p>Fortunately there is a project that specifically catalogs and manages Docker Images for R projects: <a href="https://rocker-project.org/"><code>Rocker</code></a>. The images available through the Rocker project not only include different versions of R and RStudio but also images containing collections of R packages for specific purposes (e.g.&nbsp;tidyverse for data wrangling and visualisation, geospatial packages etc.).</p>
<p>In terms of actually creating the <code>Dockerfile</code> for our R project, this can be done manually (See a good R-focused tutorial<a href="https://colinfay.me/docker-r-reproducibility/">here</a>), however there are also R packages that can help with this process such as <a href="https://thinkr-open.github.io/dockerfiler/"><code>dockerfiler</code></a> and the <code>[rrtools</code>](https://github.com/benmarwick/rrtools) package.</p>
<p>For our <a href="@sec-docker_exercise">exercise</a> of this workflow we will use the <code>dockerfiler</code> package, which creates a custom class object that represents the Dockerfile and has slots corresponding to common elements of Docker images. This allows us to add elements to the dockerfile in a more R-like way. The following code snippet demonstrates adding <code>Maintainer</code> details to a <code>Dockerfile</code> object, before saving it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dockerfiler)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dockerfile template</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>my_dock <span class="ot">&lt;-</span> Dockerfile<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add maintainer</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>my_dock<span class="sc">$</span><span class="fu">MAINTAINER</span>(<span class="st">"Jane Doe"</span>, <span class="st">"jane_doe@gmail.com"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Save</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>my_dock<span class="sc">$</span><span class="fu">write</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="docker-with-renv" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="docker-with-renv">Docker with <code>renv</code></h3>
<p>Docker can be used with the <code>renv</code> package to <a href="@sec-environment-management">manage the package environment of your project</a>.</p>
<p>There are two methods of implementing this which come with their own considerations:</p>
<ol type="1">
<li><p><strong>Use <code>renv</code> to install packages when the Docker image is built</strong>: This approach is useful if you plan to have multiple projects with <strong>identical package requirements</strong>. This because by creating an image containing this package library you can simply re-use the image as a base for new images for different projects <span class="citation" data-cites="ushey2024">[<a href="#ref-ushey2024" role="doc-biblioref">20</a>]</span>.<strong>Warning:</strong> Restoring the package library (<code>renv::restore()</code>) when building the image will be slow if there are large numbers of packages so try to avoid the need to re-build the base image many times.</p></li>
<li><p><strong>Use <code>renv</code> to install/restore packages only when Docker containers are run</strong>: This approach is better when you plan to have multiple projects that are built from the same base image but require <strong>different package requirements</strong>. Hence it is preferable to not included the package library in the image but instead to mount different project specific libraries to the container when it is run <span class="citation" data-cites="ushey2024">[<a href="#ref-ushey2024" role="doc-biblioref">20</a>]</span>. If project libraries are dynamically provisioned in this way and <code>renv::restore()</code> is run with caching this means that the packages are not re-installed everytime the container is run.</p></li>
</ol>
<!-- Presentation content -->
<div class="no-row-height column-margin column-container"><div id="ref-ushey2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">20. </div><div class="csl-right-inline">Ushey K, Wickham H (2024) <a href="https://rstudio.github.io/renv/articles/docker.html">Using renv with docker</a></div>
</div></div></section>
</section>
<section id="sec-git_workflow" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-git_workflow">Version control with <img src="assets/images/Github.dark.svg" style="vertical-align:0%; height:0.75em;"></h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/version_control_workflow.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="assets/images/version_control_workflow.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<p><strong>Version control</strong> software output can have multiple uses including creating a systematic procedure for collaboration, working as a team along with increasing the ease of reproduction of the work by other users or by the original researcher as well. We all know the difficulty of tracing back the workflow of work projects a few months down the line after having shelved it, and it is here that Git and Github can be highly useful (<span class="citation" data-cites="Alexander2023">[<a href="#ref-Alexander2023" role="doc-biblioref">21</a>]</span>).</p>
<div class="no-row-height column-margin column-container"></div><section id="about-git" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="about-git">About Git</h3>
<p><strong>Git</strong> allows us to make snapshot or record of the changes undertaken in a script, and store it as with a message that defines the change. In this way even after multiple updates, the history is preserved allowing us to revert, compare and systematically trace back the workflow development.</p>
<p><strong>Git</strong> is useful also for data scientists and researchers that work individually yet want to create systematically reproducible workflows with version control (<span class="citation" data-cites="Alexander2023">[<a href="#ref-Alexander2023" role="doc-biblioref">21</a>]</span>).</p>
<div class="no-row-height column-margin column-container"><div id="ref-Alexander2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">21. </div><div class="csl-right-inline">Alexander R (2023) <a href="https://rohanalexander.github.io/telling_stories-published/">Telling stories with data</a>, 1st Edition</div>
</div></div></section>
<section id="sec-Gitrepo" class="level3">
<h3 class="anchored" data-anchor-id="sec-Gitrepo">GitHub repositories and functionalities</h3>
<p>The version controlled code and all other auxiliary files related to the project are stored in a Github repository which was created by the user in their account on Github. A repository can either be set as public or private as per the users need for visibility of their work.</p>
<p>To help with version control Github repositories provide multiple functionalities like creating ‘branches’, ‘clones’, ‘merging’ multiple branches, setting up a ‘pull request’ before merge etc. As we get into more complicated workflows handled by multiple developers, Github allows many more functionalities as checks and balances to code development. However, we will limit our understanding to what is needed to create work with a version control history allowing for small scale collaboration, but with the main goal of creating reproducible research (<a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/about-repositories">see more details</a>).</p>
</section>
<section id="basic-functionalities" class="level3">
<h3 class="anchored" data-anchor-id="basic-functionalities">Basic functionalities</h3>
<ul>
<li><p><strong>Creating a repository and setting up user authorisations</strong>: A project repository must first be set up on GitHub as either a private or a public repository. If it is not an individual project, collaborators can be added with appropriate (read or write) permission levels (<a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-user-account-settings/permission-levels-for-a-personal-account-repository">see more details</a>). It is good to elaborate the ‘Readme’ file so as to help viewers get an idea of the repository (<a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/about-readmes">see more details</a>).</p></li>
<li><p><strong>Push and Pull</strong>: The data and code related to a project must be cloned from the remote version to a local version before changes are made. Make sure to pull from updated (i.e.&nbsp;merged branches; see below) branches before making changes. Once changes are made the user must ‘commit’ all the correct changes. Once this is done the changed code can be pushed back to the branch.</p></li>
<li><p><strong>Branching and merging</strong> : Git allows users to create <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-branches#working-with-branches">branches</a> that feed into the ‘main’ branch of a project repository on GitHub. Each branch can be created either for different tasks or for different users as per the requirement. To <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/configuring-pull-request-merges/about-merge-methods-on-github">merge branches into ‘main’ users have to set up a pull-request</a> which needs to be approved by an authorised user.</p></li>
<li><p>Git provides additionally <strong>many more <a href="https://education.github.com/git-cheat-sheet-education.pdf">functionalities</a></strong> for identifying differences between changed files or between branches, to make temporary commits and to revert back to a certain commit in history. However this is beyond the scope of this workshop.</p></li>
</ul>
</section>
<section id="git-in-r-studio" class="level3">
<h3 class="anchored" data-anchor-id="git-in-r-studio">Git in R-Studio</h3>
<p>When a Github repository is connected to an R project, R-studio adds a ‘Git’ tab (see image below) with ‘push’, ‘pull’, ‘commit’ and ‘diff’ functionalities. We can switch branches to pull from or push to and additionally trace the history of changes in the Github respository by all users.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/screenshot_R_studio_git.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22" title="Git intergration into R-Studio"><img src="assets/images/screenshot_R_studio_git.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Git intergration into R-Studio"></a></p>
</figure>
</div>
<figcaption>Git intergration into R-Studio</figcaption>
</figure>
</div>
<p>Alternatively you can also use <a href="https://github.com/apps/desktop">Github desktop</a> to perform the same functionalities.</p>
</section>
<section id="additional-functionalities" class="level3">
<h3 class="anchored" data-anchor-id="additional-functionalities">Additional functionalities</h3>
<ol type="1">
<li><p>Public Github repositories can now be archived on Zenodo as a permanent record of the work with a Digital Object Identifier (DOI) that can be cited in academic work (<a href="https://docs.github.com/en/repositories/archiving-a-github-repository/referencing-and-citing-content">Click to see more details</a>).</p></li>
<li><p>GitHub further provides advanced functionalities like <a href="https://docs.github.com/en/actions/about-github-actions/understanding-github-actions">GitHub Actions</a> that allows the user to automate certain processes for application development or project management.</p></li>
<li><p>GitHub releases can be automatically published on Docker Hub or GitHub packages as part of a Continuous Integration(CI) workflow (<a href="https://docs.github.com/en/actions/use-cases-and-examples/publishing-packages/publishing-docker-images">see more details</a>).</p></li>
</ol>
</section>
</section>
</section>
<section id="sec-Quarto" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Quarto</h1>
<!-- Web content -->
<div class="columns">
<div class="column" style="width:70%;">
<p><a href="https://quarto.org/">Quarto</a> is an open source scientific and technical publishing system developed by <a href="https://posit.co/">Posit</a> the same company that also created Rstudio. Quarto allows you to integrate code in multiple programming languages, with written material, and a wide variety of interactive visual components into a range of different document formats. If you are familiar with <a href="https://rmarkdown.rstudio.com/">Rmarkdown</a> then you will find Quarto familiar as it is in many ways an evolution of this.</p>
<p>The Quarto website presents <a href="https://quarto.org/docs/gallery/">many examples</a> of the application of the software but here we will focus on some of it’s key uses and features that are relevant for academics and producing reproducible research.</p>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/quarto_diamond_logo.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="assets/images/quarto_diamond_logo.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</div>
</div>
<section id="writing-academic-manuscripts" class="level3">
<h3 class="anchored" data-anchor-id="writing-academic-manuscripts">Writing academic manuscripts</h3>
<p>We all know how painful it can be switching between multiple programs to produce academic manuscripts, maybe you write your text in word, and produce your visualizations in R or Python before having to convert the end result to PDF for submission. This is especially annoying when you need to update parts of the manuscript as part of the review process.</p>
<p>Quarto solves this problem by allowing you to write full academic manuscripts from start to finish including text, code, and visualizations in a single program. This functionality has been expanded even further with the release of <a href="https://quarto.org/docs/manuscripts/">Quarto Manuscripts</a> as a project type from Quarto version 1.4.</p>
<p>Some key benefits of writing your manuscript with Quarto include:</p>
<ul>
<li><p>Figures and tables are dynamically updated as your code changes</p></li>
<li><p>Supports the use and inclusion of R, Python and Julia code as well as LaTeX and Markdown</p></li>
<li><p>Simple cross-referencing capability for figures, tables, and sections</p></li>
<li><p>Documents can be rendered as Word, PDF, or HTML</p></li>
<li><p>Easily include citations and bibliographies from Crossref, DataCite, and PubMed as well as with direct integration with <a href="https://www.zotero.org/">Zotero</a></p></li>
<li><p>High quality formatting options for equations and tables</p></li>
<li><p>Quarto’s <code>.qmd</code> files can be edited with various code/text editors including VS Code, RStudio and more</p></li>
<li><p>Track changes and collaborate using Git or other version control systems.</p></li>
</ul>
<p>Writing your academic manuscripts with Quarto is more reproducible as it allows others to use your underlying manuscript file in combination with your data to directly re-create your results.</p>
<p>In one of our exercises you will practice <a href="@sec-Quarto_exercise">creating a manuscript with Quarto for an example project</a></p>
</section>
<section id="presentations-with-revealjs" class="level3">
<h3 class="anchored" data-anchor-id="presentations-with-revealjs">Presentations with RevealJS</h3>
<p>Quarto also allows you to create presentations in several formats <a href="https://revealjs.com/">RevealJS</a>, <a href="https://quarto.org/docs/presentations/powerpoint.html">Microsoft Powerpoint</a> and <a href="https://quarto.org/docs/presentations/beamer.html">Beamer</a> using a common syntax. In fact the <a href="https://blenback.github.io/R-for-Reproducible-Research/presentation.html">presentation document</a> for this workshop is created using Quarto and RevealJS.</p>
<p>Some useful features of making presentations with Quarto include:</p>
<ul>
<li><p>Selection of pre-existing modern themes with functionality to publish your own theme.</p></li>
<li><p>Include interactive content: Executable code blocks and visual components (graphs and maps)</p></li>
<li><p>Dynamic resizing of content depending on screen size</p></li>
<li><p>Functionality for slide notes, automatic transitions, timers etc.</p></li>
<li><p>Easy export to PDF or HTML</p></li>
<li><p>Similar to manuscripts code-based content is dynamically updated.</p></li>
</ul>
</section>
<section id="websites" class="level3">
<h3 class="anchored" data-anchor-id="websites">Websites</h3>
<p>Quarto can also be used to create websites that can be freely hosted through Github Pages or other services like Netlify or Posit Connect. This is a great way to share your research with a wider audience or promote your work. Creating Quarto websites is an intuitive and user-friendly process and because it uses the <a href="https://getbootstrap.com/docs/5.0/getting-started/introduction/">Bootstrap</a> framework there is a lot of guidance available for customizing beyond the 25 default themes</p>
<p>Some examples from the authors:</p>
<ul>
<li><p>This website is created with Quarto and hosted on Github Pages and you can see all of it’s source code <a href="https://github.com/blenback/R-for-Reproducible-Research">here</a>.</p></li>
<li><p>This is an example of personal website created by Ben to share publications, presentations and blog content: <a href="https://blenback.github.io/" class="uri">https://blenback.github.io/</a></p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Personal_website.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-24" title="Researchers personal website"><img src="assets/images/Personal_website.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Researchers personal website"></a></p>
</figure>
</div>
<figcaption>Researchers personal website</figcaption>
</figure>
</div>
<ul>
<li>This is a Multi-lingual website created for a research project in Peru to share progress and results of the project: <a href="https://nascent-peru.github.io/" class="uri">https://nascent-peru.github.io/</a>.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/NASCENT_website.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-25" title="NASCENT-Peru website"><img src="assets/images/NASCENT_website.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="NASCENT-Peru website"></a></p>
</figure>
</div>
<figcaption>NASCENT-Peru website</figcaption>
</figure>
</div>
</section>
<section id="dashboards-to-demostrate-your-research-output" class="level3">
<h3 class="anchored" data-anchor-id="dashboards-to-demostrate-your-research-output">Dashboards to demostrate your research output</h3>
<p><a href="https://quarto.org/docs/dashboards/">Quarto dashboards</a> allow you to arrange multiple interactive or static components in a single page with a highly customizable layout. These components can include text summaries, tables, plots, maps and more. This is a great way to collect feedback on aspects of your research during the development process or to present your results in a visually appealing way.</p>
<p>Here is an interactive example produced using Python interactive plots:</p>
<figure class="figure">
<iframe width="650" height="650" src="https://jjallaire.github.io/gapminder-dashboard/" title="Gapminder dashboard from JJallaire">
</iframe>
<figcaption>
Gapminder dashboard from <a href="https://jjallaire.github.io/gapminder-dashboard/">JJallaire</a>.
</figcaption>
</figure>
<!-- ![](https://quarto.org/docs/dashboards/examples/thumbnails/customer-churn-dashboard.png){fig-align="center" width="70%"} -->
</section>
<section id="data-exploration-and-visualization" class="level3">
<h3 class="anchored" data-anchor-id="data-exploration-and-visualization">Data exploration and visualization</h3>
<p>As has been mentioned already Quarto provides a lot of options for creating interactive data visualisations, tables and diagrams using frameworks such as:</p>
<ul>
<li><a href="https://plotly.com/python/">Plotly</a></li>
<li><a href="https://ipyleaflet.readthedocs.io/en/latest/">Leaflet</a></li>
<li><a href="https://ipywidgets.readthedocs.io/en/latest/">Jupyter Widgets</a></li>
<li><a href="https://www.htmlwidgets.org/">htmlwidgets</a></li>
<li><a href="https://observablehq.com/@observablehq/observables-not-javascript">ObservableJS</a></li>
<li><a href="https://shiny.rstudio.com/">Shiny</a></li>
</ul>
<p>There are lots of examples of these on the <a href="https://quarto.org/docs/gallery/#interactive-docs">Quarto website</a> but one we particularly like is Leaflet which allows you to create interactive maps with markers, popups and other features. In a research context this is useful to others to explore the spatial results of your research. Here is a simple example we used to show the locations and timings of workshops we were conducting in Peru.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fontawesome)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>national <span class="ot">&lt;-</span> <span class="fu">makeAwesomeIcon</span>(<span class="at">text =</span> <span class="fu">fa</span>(<span class="st">"people-roof"</span>),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">iconColor =</span> <span class="st">'white'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                              <span class="at">library =</span> <span class="st">'fa'</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">markerColor =</span> <span class="st">'darkgreen'</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>regional <span class="ot">&lt;-</span> <span class="fu">makeAwesomeIcon</span>(<span class="at">text =</span> <span class="fu">fa</span>(<span class="st">"people-roof"</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                              <span class="at">iconColor =</span> <span class="st">'white'</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">library =</span> <span class="st">'fa'</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                              <span class="at">markerColor =</span> <span class="st">'lightgreen'</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="co">#uncomment for saving map</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Workshop_locations &lt;- </span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">leaflet</span>(<span class="at">options =</span> <span class="fu">leafletOptions</span>(<span class="at">zoomControl =</span> <span class="cn">FALSE</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">attributionControl=</span><span class="cn">FALSE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#addProviderTiles(providers$Esri.WorldTerrain) %&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addTiles</span>() <span class="sc">%&gt;%</span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">lng=</span><span class="sc">-</span><span class="fl">77.043</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">lat=</span><span class="sc">-</span><span class="fl">12.038</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">icon=</span> national,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">popup=</span><span class="st">"Lima, National Workshop 9th May"</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">label =</span> <span class="st">"Lima, National Workshop, 9th May"</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="co">#noHide = TRUE,</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">direction =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style =</span> <span class="fu">list</span>(<span class="st">"color"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-family"</span> <span class="ot">=</span> <span class="st">"Roboto"</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-style"</span> <span class="ot">=</span> <span class="st">"italic"</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"box-shadow"</span> <span class="ot">=</span> <span class="st">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-size"</span> <span class="ot">=</span> <span class="st">"12px"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"border-color"</span> <span class="ot">=</span> <span class="st">"rgba(0,0,0,0.5)"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">lng=</span><span class="sc">-</span><span class="fl">69.189</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">12.594</span>, <span class="at">icon =</span> regional, <span class="at">popup=</span><span class="st">"Puerto Maldonado, Regional Workshop"</span>, <span class="at">label =</span> <span class="st">"Puerto Maldonado Regional Workshop 28th May"</span>,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="co">#noHide = TRUE,</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">direction =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style =</span> <span class="fu">list</span>(<span class="st">"color"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-family"</span> <span class="ot">=</span> <span class="st">"Roboto"</span>,</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-style"</span> <span class="ot">=</span> <span class="st">"italic"</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"box-shadow"</span> <span class="ot">=</span> <span class="st">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-size"</span> <span class="ot">=</span> <span class="st">"12px"</span>,</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"border-color"</span> <span class="ot">=</span> <span class="st">"rgba(0,0,0,0.5)"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">lng=</span><span class="sc">-</span><span class="fl">77.529</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">9.526</span>, <span class="at">icon =</span> regional, <span class="at">popup=</span><span class="st">"Huaraz, Regional Workshop"</span>, <span class="at">label =</span> <span class="st">"Huaraz, Regional Workshop 4th June"</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="co">#noHide = TRUE,</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">direction =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style =</span> <span class="fu">list</span>(<span class="st">"color"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-family"</span> <span class="ot">=</span> <span class="st">"Roboto"</span>,</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-style"</span> <span class="ot">=</span> <span class="st">"italic"</span>,</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"box-shadow"</span> <span class="ot">=</span> <span class="st">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-size"</span> <span class="ot">=</span> <span class="st">"12px"</span>,</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"border-color"</span> <span class="ot">=</span> <span class="st">"rgba(0,0,0,0.5)"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">lng=</span><span class="sc">-</span><span class="fl">76.370</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">6.485</span>, <span class="at">icon =</span> regional, <span class="at">popup=</span><span class="st">"Tarapoto, Regional Workshop"</span>, <span class="at">label =</span> <span class="st">"Tarapoto, Regional Workshop 10th June"</span>,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="co">#noHide = TRUE,</span></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">direction =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style =</span> <span class="fu">list</span>(<span class="st">"color"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-family"</span> <span class="ot">=</span> <span class="st">"Roboto"</span>,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-style"</span> <span class="ot">=</span> <span class="st">"italic"</span>,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"box-shadow"</span> <span class="ot">=</span> <span class="st">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-size"</span> <span class="ot">=</span> <span class="st">"12px"</span>,</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"border-color"</span> <span class="ot">=</span> <span class="st">"rgba(0,0,0,0.5)"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">lng=</span><span class="sc">-</span><span class="fl">80.63282</span>, <span class="at">lat=</span><span class="sc">-</span><span class="fl">5.19449</span>, <span class="at">icon =</span> regional, <span class="at">popup=</span><span class="st">"Piura, Regional Workshop"</span>, <span class="at">label=</span><span class="st">"Piura, Regional Workshop 20th May"</span>,</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labelOptions =</span> <span class="fu">labelOptions</span>(<span class="co">#noHide = TRUE,</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">direction =</span> <span class="st">"bottom"</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">style =</span> <span class="fu">list</span>(<span class="st">"color"</span> <span class="ot">=</span> <span class="st">"black"</span>,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-family"</span> <span class="ot">=</span> <span class="st">"Roboto"</span>,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-style"</span> <span class="ot">=</span> <span class="st">"italic"</span>,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"box-shadow"</span> <span class="ot">=</span> <span class="st">"3px 3px rgba(0,0,0,0.25)"</span>,</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"font-size"</span> <span class="ot">=</span> <span class="st">"12px"</span>,</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"border-color"</span> <span class="ot">=</span> <span class="st">"rgba(0,0,0,0.5)"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-1b267dc1f8f80c1dbd9a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1b267dc1f8f80c1dbd9a">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"zoomControl":false,"attributionControl":false},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addAwesomeMarkers","args":[-12.038,-77.04300000000001,{"icon":"home","markerColor":"darkgreen","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","text":"<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M335.5 4l288 160c15.4 8.6 21 28.1 12.4 43.5s-28.1 21-43.5 12.4L320 68.6 47.5 220c-15.4 8.6-34.9 3-43.5-12.4s-3-34.9 12.4-43.5L304.5 4c9.7-5.4 21.4-5.4 31.1 0zM320 160a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM144 256a40 40 0 1 1 0 80 40 40 0 1 1 0-80zm312 40a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM226.9 491.4L200 441.5V480c0 17.7-14.3 32-32 32H120c-17.7 0-32-14.3-32-32V441.5L61.1 491.4c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l37.9-70.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c16.3 0 31.9 4.5 45.4 12.6l33.6-62.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c32.4 0 62.1 17.8 77.5 46.3l33.6 62.3c13.5-8.1 29.1-12.6 45.4-12.6h19.5c32.4 0 62.1 17.8 77.5 46.3l37.9 70.3c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8L552 441.5V480c0 17.7-14.3 32-32 32H472c-17.7 0-32-14.3-32-32V441.5l-26.9 49.9c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l36.3-67.5c-1.7-1.7-3.2-3.6-4.3-5.8L376 345.5V400c0 17.7-14.3 32-32 32H296c-17.7 0-32-14.3-32-32V345.5l-26.9 49.9c-1.2 2.2-2.6 4.1-4.3 5.8l36.3 67.5c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8z\"/><\/svg>","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Lima, National Workshop 9th May",null,null,null,"Lima, National Workshop, 9th May",{"interactive":false,"permanent":false,"direction":"bottom","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"Roboto","font-style":"italic","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[-12.594,-69.18899999999999,{"icon":"home","markerColor":"lightgreen","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","text":"<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M335.5 4l288 160c15.4 8.6 21 28.1 12.4 43.5s-28.1 21-43.5 12.4L320 68.6 47.5 220c-15.4 8.6-34.9 3-43.5-12.4s-3-34.9 12.4-43.5L304.5 4c9.7-5.4 21.4-5.4 31.1 0zM320 160a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM144 256a40 40 0 1 1 0 80 40 40 0 1 1 0-80zm312 40a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM226.9 491.4L200 441.5V480c0 17.7-14.3 32-32 32H120c-17.7 0-32-14.3-32-32V441.5L61.1 491.4c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l37.9-70.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c16.3 0 31.9 4.5 45.4 12.6l33.6-62.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c32.4 0 62.1 17.8 77.5 46.3l33.6 62.3c13.5-8.1 29.1-12.6 45.4-12.6h19.5c32.4 0 62.1 17.8 77.5 46.3l37.9 70.3c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8L552 441.5V480c0 17.7-14.3 32-32 32H472c-17.7 0-32-14.3-32-32V441.5l-26.9 49.9c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l36.3-67.5c-1.7-1.7-3.2-3.6-4.3-5.8L376 345.5V400c0 17.7-14.3 32-32 32H296c-17.7 0-32-14.3-32-32V345.5l-26.9 49.9c-1.2 2.2-2.6 4.1-4.3 5.8l36.3 67.5c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8z\"/><\/svg>","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Puerto Maldonado, Regional Workshop",null,null,null,"Puerto Maldonado Regional Workshop 28th May",{"interactive":false,"permanent":false,"direction":"bottom","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"Roboto","font-style":"italic","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[-9.526,-77.529,{"icon":"home","markerColor":"lightgreen","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","text":"<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M335.5 4l288 160c15.4 8.6 21 28.1 12.4 43.5s-28.1 21-43.5 12.4L320 68.6 47.5 220c-15.4 8.6-34.9 3-43.5-12.4s-3-34.9 12.4-43.5L304.5 4c9.7-5.4 21.4-5.4 31.1 0zM320 160a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM144 256a40 40 0 1 1 0 80 40 40 0 1 1 0-80zm312 40a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM226.9 491.4L200 441.5V480c0 17.7-14.3 32-32 32H120c-17.7 0-32-14.3-32-32V441.5L61.1 491.4c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l37.9-70.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c16.3 0 31.9 4.5 45.4 12.6l33.6-62.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c32.4 0 62.1 17.8 77.5 46.3l33.6 62.3c13.5-8.1 29.1-12.6 45.4-12.6h19.5c32.4 0 62.1 17.8 77.5 46.3l37.9 70.3c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8L552 441.5V480c0 17.7-14.3 32-32 32H472c-17.7 0-32-14.3-32-32V441.5l-26.9 49.9c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l36.3-67.5c-1.7-1.7-3.2-3.6-4.3-5.8L376 345.5V400c0 17.7-14.3 32-32 32H296c-17.7 0-32-14.3-32-32V345.5l-26.9 49.9c-1.2 2.2-2.6 4.1-4.3 5.8l36.3 67.5c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8z\"/><\/svg>","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Huaraz, Regional Workshop",null,null,null,"Huaraz, Regional Workshop 4th June",{"interactive":false,"permanent":false,"direction":"bottom","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"Roboto","font-style":"italic","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[-6.485,-76.37,{"icon":"home","markerColor":"lightgreen","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","text":"<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M335.5 4l288 160c15.4 8.6 21 28.1 12.4 43.5s-28.1 21-43.5 12.4L320 68.6 47.5 220c-15.4 8.6-34.9 3-43.5-12.4s-3-34.9 12.4-43.5L304.5 4c9.7-5.4 21.4-5.4 31.1 0zM320 160a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM144 256a40 40 0 1 1 0 80 40 40 0 1 1 0-80zm312 40a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM226.9 491.4L200 441.5V480c0 17.7-14.3 32-32 32H120c-17.7 0-32-14.3-32-32V441.5L61.1 491.4c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l37.9-70.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c16.3 0 31.9 4.5 45.4 12.6l33.6-62.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c32.4 0 62.1 17.8 77.5 46.3l33.6 62.3c13.5-8.1 29.1-12.6 45.4-12.6h19.5c32.4 0 62.1 17.8 77.5 46.3l37.9 70.3c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8L552 441.5V480c0 17.7-14.3 32-32 32H472c-17.7 0-32-14.3-32-32V441.5l-26.9 49.9c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l36.3-67.5c-1.7-1.7-3.2-3.6-4.3-5.8L376 345.5V400c0 17.7-14.3 32-32 32H296c-17.7 0-32-14.3-32-32V345.5l-26.9 49.9c-1.2 2.2-2.6 4.1-4.3 5.8l36.3 67.5c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8z\"/><\/svg>","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Tarapoto, Regional Workshop",null,null,null,"Tarapoto, Regional Workshop 10th June",{"interactive":false,"permanent":false,"direction":"bottom","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"Roboto","font-style":"italic","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]},{"method":"addAwesomeMarkers","args":[-5.19449,-80.63282,{"icon":"home","markerColor":"lightgreen","iconColor":"white","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","text":"<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 640 512\" style=\"height:1em;width:1.25em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M335.5 4l288 160c15.4 8.6 21 28.1 12.4 43.5s-28.1 21-43.5 12.4L320 68.6 47.5 220c-15.4 8.6-34.9 3-43.5-12.4s-3-34.9 12.4-43.5L304.5 4c9.7-5.4 21.4-5.4 31.1 0zM320 160a40 40 0 1 1 0 80 40 40 0 1 1 0-80zM144 256a40 40 0 1 1 0 80 40 40 0 1 1 0-80zm312 40a40 40 0 1 1 80 0 40 40 0 1 1 -80 0zM226.9 491.4L200 441.5V480c0 17.7-14.3 32-32 32H120c-17.7 0-32-14.3-32-32V441.5L61.1 491.4c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l37.9-70.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c16.3 0 31.9 4.5 45.4 12.6l33.6-62.3c15.3-28.5 45.1-46.3 77.5-46.3h19.5c32.4 0 62.1 17.8 77.5 46.3l33.6 62.3c13.5-8.1 29.1-12.6 45.4-12.6h19.5c32.4 0 62.1 17.8 77.5 46.3l37.9 70.3c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8L552 441.5V480c0 17.7-14.3 32-32 32H472c-17.7 0-32-14.3-32-32V441.5l-26.9 49.9c-6.3 11.7-20.8 16-32.5 9.8s-16-20.8-9.8-32.5l36.3-67.5c-1.7-1.7-3.2-3.6-4.3-5.8L376 345.5V400c0 17.7-14.3 32-32 32H296c-17.7 0-32-14.3-32-32V345.5l-26.9 49.9c-1.2 2.2-2.6 4.1-4.3 5.8l36.3 67.5c6.3 11.7 1.9 26.2-9.8 32.5s-26.2 1.9-32.5-9.8z\"/><\/svg>","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Piura, Regional Workshop",null,null,null,"Piura, Regional Workshop 20th May",{"interactive":false,"permanent":false,"direction":"bottom","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"style":{"color":"black","font-family":"Roboto","font-style":"italic","box-shadow":"3px 3px rgba(0,0,0,0.25)","font-size":"12px","border-color":"rgba(0,0,0,0.5)"},"className":"","sticky":true},null]}],"limits":{"lat":[-12.594,-5.19449],"lng":[-80.63282,-69.18899999999999]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<!-- Presentation content -->
</section>
</section>
<section id="sec-exercises" class="level1 page-columns page-full" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Guided excercises</h1>
<p>Now it’s time to get hands on with some guided exercises that will let you put into practice the <a href="@sec-workflows">three workflows for reproducible research</a> that we have introduced as well as writing a academic manuscript using <a href="@sec-Quarto">Quarto</a>. Each exercise is available to download as a PDF if you prefer to view the instructions offline and the files required for each are available to download at the start of each exercise.</p>
<section id="sec-Rproj_zenodo_exercise" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="sec-Rproj_zenodo_exercise">RStudio Project to Zenodo exercise</h2>
<p>In this exercise you will setup of a basic RStudio project following good practices for organizing data, writing clean code and decomposing your workflow introduced in <a href="@sec-projects">Rproject section</a>. We‘ll also initialize <code>renv</code> to manage package dependencies, ensuring reproducibility. Once the project is set up, we’ll go through the process of how to publish the project to Zenodo as described in the <a href="@sec-zenodo_workflow">Zenodo workflow</a> section.</p>
<p>If you would prefer to view the exercise script offline, here is a PDF version: <a href="https://blenback.github.io/R-for-Reproducible-Research/exercises/Rproj-Zenodo_exercise.pdf" class="download"><i class="fa fa-download"></i> <b>Download exercise instructions</b></a></p>
<section id="step-1-download-the-exercise-resources" class="level3">
<h3 class="anchored" data-anchor-id="step-1-download-the-exercise-resources">Step 1: Download the exercise resources</h3>
<ul>
<li>Click here to download the resources for the exercise: <a href="https://drive.google.com/uc?export=download&amp;id=1V30Aa43u-OhUZ829yWZNxWAybz151MGY" class="download"><i class="fa fa-download"></i> <b>Download resources for exercise</b></a></li>
<li>Unzip the downloaded file and move the folder to a location on your computer where you can easily find it.</li>
</ul>
</section>
<section id="step-2-create-a-new-rstudio-project" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-a-new-rstudio-project">Step 2: Create a new RStudio Project</h3>
<p>Start by creating a new RStudio project in the root of the <code>exercise_1_data</code> directory. you have just downloaded. You can name the project what you like but in this example, we have named it <code>Rice_farm_analysis.proj</code>.</p>
<ul>
<li>Open RStudio.</li>
<li>Create the project using: <em>File &gt; New Project &gt; Existing Directory</em>.</li>
<li>Select the <code>exercise_1_data</code> folder as the location and give the project a name, for example, <code>Rice_farm_analysis.proj</code>.</li>
</ul>
<p>This creates a <code>.Rproj</code> file in the root of your project to help manage the workspace and project-specific settings.</p>
</section>
<section id="step-3-organize-your-data" class="level3">
<h3 class="anchored" data-anchor-id="step-3-organize-your-data">Step 3: Organize Your Data</h3>
<p>It’s good practice to organize raw and processed data in separate folders. Let’s start by organizing the data:</p>
<ul>
<li>Create a directory <code>Data/Raw</code> inside your project folder.</li>
<li>Move the provided CSV file into this <code>Data/Raw</code> directory.</li>
</ul>
</section>
<section id="step-4-organize-and-split-your-scripts" class="level3">
<h3 class="anchored" data-anchor-id="step-4-organize-and-split-your-scripts">Step 4: Organize and Split Your Scripts</h3>
<p>We’ll now organize the project’s scripts by splitting the original script into separate analysis and visualization scripts.</p>
<ul>
<li>Create a <code>Scripts</code> folder inside your project directory.</li>
<li>Move the original <code>RiceFarm_project.R</code> script into the <code>Scripts</code> folder.</li>
</ul>
<p>We’ll now organize the project’s scripts by splitting the original script into separate <em>analysis</em> and <em>visualization</em> scripts.</p>
<ul>
<li>Create a <code>scripts</code> folder inside your project directory.</li>
<li>Move the original <code>RiceFarm_project.R</code> script into the <code>Scripts</code> folder.</li>
<li>Create two new scripts named <code>01_data_analysis.R</code> and <code>02_data_visualisation.R</code>.</li>
</ul>
<section id="for-01_data_analysis.r" class="level4">
<h4 class="anchored" data-anchor-id="for-01_data_analysis.r">For <code>01_data_analysis.R</code></h4>
<ul>
<li><p>Copy the following code from <code>RiceFarm_project.R</code>:</p>
<ul>
<li>The call to the relevant library <code>library(stringr)</code></li>
<li>Everything before the call to the <code>ggplot()</code> function</li>
</ul></li>
<li><p>In addition to this, replace the <code>setwd()</code> function with this code to set up relative paths, create a directory to save the processed data in and save <code>rice_data_summary</code> to disk after processing:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vector and create processed data save dir</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>save_dir <span class="ot">&lt;-</span> <span class="st">"Data/Processed"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(save_dir,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">showWarnings =</span> <span class="cn">FALSE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load csv file of data</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>rice_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">file.path</span>(raw_dir, <span class="st">"RiceFarms.csv"</span>))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the summarized data</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(rice_data_summary,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">file.path</span>(save_dir, <span class="st">"RiceFarms_summary.csv"</span>),</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="for-02_data_visualisation.r" class="level4">
<h4 class="anchored" data-anchor-id="for-02_data_visualisation.r">For <code>02_data_visualisation.R</code></h4>
<ul>
<li><p>Copy the following code from <code>RiceFarm_project.R</code>:</p>
<ul>
<li>The call to the relevant library <code>library(ggplot2)</code></li>
<li>The call to the functions <code>ggplot()</code> and <code>ggsave()</code></li>
</ul></li>
<li><p>Add the following code after the <code>library()</code> call to create an output directory for the plots and load the summarized data from the processed data folder:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory for saving plots</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>plot_dir <span class="ot">&lt;-</span> <span class="st">"Output/Visualisations"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(plot_dir, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load the summarized data</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>rice_data_summary <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/Processed/RiceFarms_summary.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="step-5-add-script-headers" class="level3">
<h3 class="anchored" data-anchor-id="step-5-add-script-headers">Step 5: Add Script Headers</h3>
<ul>
<li>Add headers to both new scripts. You can use this template:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Script Name: [01_data_analysis.R / 02_data_visualisation.R]</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Project: Rice Farm Analysis</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Purpose: [Data analysis / Data visualization]</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: [Your Name]</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Date: [YYYY-MM-DD]</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------------------------------</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-6-create-a-master-script" class="level3">
<h3 class="anchored" data-anchor-id="step-6-create-a-master-script">Step 6: Create a master script</h3>
<p>As a next step you will create a master script that runs both the data analysis and visualization scripts.</p>
<ul>
<li><p>In the root of your project, create a new file named <code>RiceFarm_master.R</code></p></li>
<li><p>Add a header as in Step 5.</p></li>
<li><p>Add the following code snippet to the script to source <code>01_data_analysis.R</code> and <code>02_data_visualisation.R</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">###=========================================================================</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">### 01- Data analysis</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Source the data analysis script</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Scripts/01_data_analysis.R"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">### 02- Data visualization</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">### =========================================================================</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Source the data visualization script</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Scripts/02_data_visualisation.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Running this master script will execute both analysis and visualization steps.</p>
</section>
<section id="step-7-initialize-renv-to-manage-package-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="step-7-initialize-renv-to-manage-package-dependencies">Step 7: Initialize <code>renv</code> to manage package dependencies</h3>
<p>We will use <a href="https://rstudio.github.io/renv/articles/renv.html"><code>renv</code></a> to make your projects package environment reproducible.</p>
<ul>
<li>install renv package</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"renv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Run the following command in your master script to set up the project-specific environment</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">init</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This creates a local library for your project and captures the required packages.</p>
<ul>
<li>Once the initialization is complete, run:</li>
</ul>
</section>
<section id="step-8-automate-opening-the-master-script" class="level3">
<h3 class="anchored" data-anchor-id="step-8-automate-opening-the-master-script">Step 8: Automate Opening the Master Script</h3>
<p>For convenience, we can configure RStudio to automatically open the master script when the project is loaded.</p>
<ul>
<li>install the rstudioapi package:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"rstudioapi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Open the <code>.Rprofile</code> file in the root of your project directory. The file might be hidden. On Windows click “View” &gt; “Show” &gt; “Hidden items” in the explorer and on MacOS click Press Command+Shift+Dot within the root directory to see the file.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This records the project’s environment in a <code>renv.lock</code> file, which is essential for reproducibility.</p>
</section>
<section id="step-8-automate-opening-of-the-master-script" class="level3">
<h3 class="anchored" data-anchor-id="step-8-automate-opening-of-the-master-script">Step 8: Automate opening of the master script</h3>
<p>For convenience, we will configure RStudio to automatically open the master script when the project is loaded.</p>
<ul>
<li><p>Open the <code>.Rprofile</code> file in the root of your project directory. The file might be hidden. On Windows click <em>View &gt; Show &gt; Hidden items</em> in the explorer and on MacOS click Press Command+Shift+Dot within the root directory to see the file.</p></li>
<li><p>Add the following R code to the <code>.Rprofile</code> file:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rsetHook</span>(<span class="st">"rstudio.sessionInit"</span>, <span class="cf">function</span>(newSession) {</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (newSession)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    rstudioapi<span class="sc">::</span><span class="fu">navigateToFile</span>(<span class="st">'RiceFarm_master.R'</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>L, <span class="at">column =</span> <span class="sc">-</span><span class="dv">1</span>L)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>}, <span class="at">action =</span> <span class="st">"append"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-9-re-snapshot-the-project" class="level3">
<h3 class="anchored" data-anchor-id="step-9-re-snapshot-the-project">Step 9: Re-snapshot the Project</h3>
<p>After modifying the <code>.Rprofile</code> file, it’s important to capture these changes in the <code>renv.lock</code> file.</p>
<ul>
<li>Run the following command in your master script to ensure that the <code>rstudioapi</code> package (which enables automatic script opening) is included in the snapshot:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>renv<span class="sc">::</span><span class="fu">snapshot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we a have a nicely organised project structure with the workflow decomposed into seperate scripts and a master script that to run the whole project.</p>
</section>
<section id="step-10-install-zen4r-to-access-zenodo-through-r" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="step-10-install-zen4r-to-access-zenodo-through-r">Step 10: Install <code>zen4R</code> to access Zenodo through R</h3>
<p>The following steps are heavily based on <span class="citation" data-cites="blondel2024">[<a href="#ref-blondel2024" role="doc-biblioref">19</a>]</span>. We have extracted the most relevant parts to explain the workflow. If you are interested in more details, check out their user manual at: https://cran.r-project.org/web/packages/zen4R/vignettes/zen4R.html.</p>
<div class="no-row-height column-margin column-container"><div id="ref-blondel2024" class="csl-entry" role="listitem">
<div class="csl-left-margin">19. </div><div class="csl-right-inline">Blondel E, Barde J (2024) <a href="https://doi.org/10.5281/zenodo.11500665"><span class="nocase">zen4R</span>: <span>R</span> <span>Interface</span> to <span>Zenodo</span> <span>REST</span> <span>API</span></a></div>
</div></div><p>For this exercise we will not be using Zenodo directly but Zenodo Sandbox. The Zenodo Sandbox is a separate, secure testing environment where users can explore Zenodo‘s features without impacting the main platform‘s publicly accessible data. It allows you to test file uploads, generate test DOIs, and experiment with API integrations. DOIs created in the sandbox are only for testing and use a different prefix. You will need a separate account and access token for the sandbox, distinct from those used on Zenodo‘s main site.</p>
<ul>
<li>Create an account on <a href="https://sandbox.zenodo.org">https://sandbox.zenodo.org</a>.</li>
</ul>
<p>Zenodo can be accessed with the R package <code>zen4R</code> to upload, edit, publish and download data.</p>
<ul>
<li>Create a new R script outside of the project directory.</li>
<li>Install zen4R library with the following code:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install dependency "remotes"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install zen4R</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(<span class="st">"remotes"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"eblondel/zen4R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-11-create-a-new-zenodo-record" class="level3">
<h3 class="anchored" data-anchor-id="step-11-create-a-new-zenodo-record">Step 11: Create a new Zenodo record</h3>
<p>A Zenodo record includes metadata, data and a Digital Object Identifier (DOI) which is automatically generated by Zenodo for all uploads. But before you can add records to Zenodo, you need to get access to your account through R.</p>
<ul>
<li>Go to <a href="https://sandbox.zenodo.org/account/settings/applications/">https://sandbox.zenodo.org/account/settings/applications/</a>.</li>
<li>Log into your account and then create a new “Personal access token” in the “Applications” section of your account.</li>
<li>Then run the following code in your script to establish the access and create a new record.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zen4R)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Create manager to access your Zenodo repository</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>zenodo <span class="ot">&lt;-</span> ZenodoManager<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">token =</span> <span class="st">"your_token"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sandbox =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">logger =</span> <span class="st">"INFO"</span> </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="do">##Prepare a new record to be filled with metadata and uploaded to Zenodo</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> ZenodoRecord<span class="sc">$</span><span class="fu">new</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you want to connect to Zenodo and not Zenodo Sandbox, create the token in your Zenodo account and remove the line <code>sandbox = True</code> in the code above.</p>
<p>The types of metadata that can be included in a Zenodo record are vast. A full list can be found in the <a href="https://developers.zenodo.org/#representation">documentation</a>.</p>
<ul>
<li>Copy and run the example below to add metadata to your record.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setTitle</span>(<span class="st">"RiceFarm"</span>) <span class="co">#title of the record</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">addAdditionalTitle</span>(<span class="st">"This is an alternative title"</span>, <span class="at">type =</span> <span class="st">"alternative-title"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setDescription</span>(<span class="st">"Calculating statistics of RiceFarm dataset"</span>) <span class="co">#description</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">addAdditionalDescription</span>(<span class="st">"This is an abstract"</span>, <span class="at">type =</span> <span class="st">"abstract"</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setPublicationDate</span>(<span class="st">"2024-09-16"</span>) <span class="co">#Format YYYY-MM-DD</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setResourceType</span>(<span class="st">"dataset"</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">addCreator</span>(<span class="at">firstname =</span> <span class="st">"Yourfirstname"</span>, <span class="at">lastname =</span> <span class="st">"Yourlastname"</span>, <span class="at">role =</span> <span class="st">"datamanager"</span>, <span class="at">orcid =</span> <span class="st">"0000-0001-0002-0003"</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setKeywords</span>(<span class="fu">c</span>(<span class="st">"R"</span>,<span class="st">"dataset"</span>)) <span class="co">#For filtering</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">addReference</span>(<span class="st">"Blondel E. et al., 2024 zen4R: R Interface to Zenodo REST API"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A record can be deposited on Zenodo before it is published. This will add the record to your account without making it public yet. A deposited record can still be edited or deleted. You can also upload data to a deposited record. If you prefer a graphical interface, you can also edit the record on the Zenodo website.</p>
<ul>
<li>Deposit the record on Zenodo:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#deposit record</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">depositRecord</span>(myrec, <span class="at">publish =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>View the deposited record at https://sandbox.zenodo.org/me/uploads?q=&amp;l=list&amp;p=1&amp;s=10&amp;sort=newest</p></li>
<li><p>Compress your project directory to a .zip file.</p></li>
<li><p>Upload the .zip file to your deposited record:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add data to the record, adjust the path below</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>zenodo<span class="sc">$</span><span class="fu">uploadFile</span>(<span class="st">"path/to/your/file"</span>, <span class="at">record =</span> myrec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Publish the record:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make the record publicly available on Zenodo (Sandbox).</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">publishRecord</span>(myrec<span class="sc">$</span>id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-12-edit-a-published-zenodo-record" class="level3">
<h3 class="anchored" data-anchor-id="step-12-edit-a-published-zenodo-record">Step 12: Edit a published Zenodo record</h3>
<ul>
<li>It is also possible to edit or update the metadata of published records:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get your record by metadata query, e.g. by title</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">getDepositions</span>(<span class="at">q=</span><span class="st">'title:zen4R'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get depositions creates a list, access first element</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> myrec[[<span class="dv">1</span>]]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#edit metadata</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">editRecord</span>(myrec<span class="sc">$</span>id)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>myrec<span class="sc">$</span><span class="fu">setTitle</span>(<span class="st">"zen4R 2.0"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#redeposit and publish the edited record</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">depositRecord</span>(myrec, <span class="at">publish =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Once a record has been published, it is not possible to edit the data that has been attached to it. However, it is possible to upload an updated version of the data. The previous version of the data will remain accessible via Zenodo. The record will have one overall DOI, while each version will have its own DOI.</p></li>
<li><p>Reconnect to your account:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>zenodo <span class="ot">&lt;-</span> ZenodoManager<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">token =</span> <span class="st">"your_token"</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">sandbox =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">logger =</span> <span class="st">"INFO"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Access your record:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get your record by querying the metadata, e.g. by title, this will give you a list of all records with that title.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">getDepositions</span>(<span class="at">q=</span><span class="st">'title:RiceFarm Statistics'</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co">#access the first item in the list, as there should only be one record with that particular title</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> myrec[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Rename your .zip file on your computer</li>
<li>Upload the renamed .zip file:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#edit data, delete_latest_files = TRUE to not include data of previous version in newer version</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>myrec <span class="ot">&lt;-</span> zenodo<span class="sc">$</span><span class="fu">depositRecordVersion</span>(myrec, <span class="at">delete_latest_files =</span> <span class="cn">TRUE</span>, <span class="at">files =</span> <span class="st">"path/to/your/new/file"</span>, <span class="at">publish =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Again, go to https://sandbox.zenodo.org/me/uploads?q=&amp;l=list&amp;p=1&amp;s=10&amp;sort=newest</li>
<li>Activate “View all versions” on the left hand side.</li>
<li>Check if both versions show up</li>
</ul>
</section>
</section>
<section id="sec-docker_exercise" class="level2">
<h2 class="anchored" data-anchor-id="sec-docker_exercise">Containerization with Docker exercise</h2>
<p>In this exercise we will create and run a Docker container for an example R project. The project is the same that is created in the first workflow <a href="@sec-Rproj_zenodo_exercise">exercise</a>, however to save time or in case you haven’t completed this exercise we will start with the finished output from it.</p>
<p><strong>Warning</strong>: Docker is a complex software and getting Docker Desktop running on different machines is not always smooth. For example, I had no problem getting it running on my desktop computer but my work laptop did not have the capabilities. If you do run into issues there is good support available online but also asking for help from your IT department may be a good idea.</p>
<p>If you would prefer to view the exercise script offline, here is a PDF version: <a href="https://blenback.github.io/R-for-Reproducible-Research/exercises/Docker_exercise.pdf" class="download"><i class="fa fa-download"></i> <b>Download exercise instructions</b></a></p>
<section id="step-1-download-the-resources" class="level3">
<h3 class="anchored" data-anchor-id="step-1-download-the-resources">Step 1: Download the resources</h3>
<ul>
<li><p>Click here to download the resources for the exercise: <a href="https://drive.google.com/uc?export=download&amp;id=1TN3DZqetynnNWlTeV2eKqJDcU53fq9Zg" class="download"><i class="fa fa-download"></i> <b>Download resources for exercise</b></a></p></li>
<li><p>Unzip the downloaded file and move the folder to a location on your computer where you can easily find it.</p></li>
</ul>
</section>
<section id="step-2-download-docker" class="level3">
<h3 class="anchored" data-anchor-id="step-2-download-docker">Step 2: Download Docker</h3>
<ul>
<li><p>Download Docker Desktop for your operating system from the <a href="https://www.docker.com/products/docker-desktop">Docker website</a>.</p></li>
<li><p>Once downloaded run the installer like you would for other software. If your computer is managed by your institution or your employer you will likely need an admin account to run the installer and you may need to restart your computer after installation.</p></li>
<li><p>While you are running the installer it is useful to make a Docker account. This is not necessary but can be useful for managing your containers. You can also sign in with your GitHub account.</p></li>
</ul>
</section>
<section id="step-3-open-docker-desktop" class="level3">
<h3 class="anchored" data-anchor-id="step-3-open-docker-desktop">Step 3: Open Docker desktop</h3>
<ul>
<li><p>Open the Docker desktop app. If the app does not open you may need to yourself to the program user-group on your computer. This is a common issue on Windows machines because only the admin account is added to the user-group by default. To add yourself to the user-group search computer management in the start menu and right-click and select to run it with admin privileges. Then navigate to Local Users and Groups -&gt; Groups -&gt; Docker Users. Right click on Docker Users and select Add to Group. Then add your user account to the group.</p></li>
<li><p>Once the Docker desktop app is open it should automatically start the docker engine which is the software that runs the containers. In the bottom left of app window you will see the status of the engine.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/Docker_running_app.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26" title="Docker Engine status in app"><img src="assets/images/Docker_running_app.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker Engine status in app"></a></p>
</figure>
</div>
<figcaption>Docker Engine status in app</figcaption>
</figure>
</div>
<p>Alternatively if you look in the system tray on Windows or the top menu bar on Mac. You will see an icon of the Docker whale logo and if you click on this you can see the status of the engine.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_running_desktop.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27" title="Docker Engine status in system try"><img src="./assets/images/Docker_running_desktop.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker Engine status in system try"></a></p>
</figure>
</div>
<figcaption>Docker Engine status in system try</figcaption>
</figure>
</div>
</section>
<section id="step-4-creating-the-dockerfile" class="level3">
<h3 class="anchored" data-anchor-id="step-4-creating-the-dockerfile">Step 4: Creating the Dockerfile</h3>
<ul>
<li>Open Rstudio and navigate to the folder you downloaded in step 1.</li>
<li>Create a new R script and name it <code>Create_Dockerfile.R</code>.</li>
<li>Install the Dockerfiler package: <code>install.packages("dockerfiler")</code>.</li>
<li>Add the following code to the script and replace the entries with your details:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load dockerfiler package</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dockerfiler)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get your R version to select a base image to use for your image/container</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">R.Version</span>()<span class="sc">$</span>version.string </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a dockerfile template object using the Dockerfile class from the</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dockerfiler package and specify your version of R in the base image name</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># my version is 4.3.1 hence the base image is rocker/r-ver:4.3.1</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># but you should replace the end of this string with your version number from above</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock <span class="ot">&lt;-</span> Dockerfile<span class="sc">$</span><span class="fu">new</span>(<span class="at">FROM =</span> <span class="st">"rocker/r-ver:4.3.1"</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add maintainer information (replace with your details)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">MAINTAINER</span>(<span class="st">"Your_name"</span>, <span class="st">"Your_email"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co"># By default docker images contain a home directory and because our project</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># is simple we will move the files we need there</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the data directory </span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co"># (1st argument is the source, 2nd is the destination in the container)</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">COPY</span>(<span class="st">"/Data"</span>, <span class="st">"/home/Data"</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the scripts directory</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">COPY</span>(<span class="st">"/Scripts"</span>, <span class="st">"/home/Scripts"</span>)</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Copy the master script</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">COPY</span>(<span class="st">"/RiceFarm_master.R"</span>, <span class="st">"/home"</span>)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a><span class="co"># For our project we need "ggplot2" and "stringr" packages</span></span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="co"># We could try to find a base image on Rocker that has these installed</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="co"># But because we are not using lots of packages lets just install them in the container</span></span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that the R commands are wrapped in `r()` which is a helper function from dockerfiler</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a><span class="co"># that then wraps the command in the correct syntax for the Dockerfile</span></span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">RUN</span>(<span class="fu">r</span>(<span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)))</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">RUN</span>(<span class="fu">r</span>(<span class="fu">install.packages</span>(<span class="st">"stringr"</span>)))</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the command to run the master script</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the use of `Rscript` which is the command line tool included with R to run scripts</span></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">CMD</span>(<span class="st">"Rscript /home/RiceFarm_master.R "</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the Dockerfile</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>RiceFarm_dock<span class="sc">$</span><span class="fu">write</span>()</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dir in the host directory to receive the results from container</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">"/output"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>After running this code you will see that a <code>Dockerfile</code> has been created in the directory where you downloaded the resources.</li>
</ul>
</section>
<section id="step-5-creating-the-docker-image" class="level3">
<h3 class="anchored" data-anchor-id="step-5-creating-the-docker-image">Step 5: Creating the Docker image</h3>
<ul>
<li><p>The Docker command <code>build</code> is used to create a <code>Docker image</code> from the instructions contained in your <code>Dockerfile</code>.</p></li>
<li><p>The <code>build</code> command should be called through a Command Line Interface (CLI) such as the terminal in Rstudio or the CLI of your operating system (e.g Command Prompt for Windows).</p></li>
<li><p>In Rstudio switch to the terminal tab next to the console pane:</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_terminal.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28" title="Rstudio terminal"><img src="./assets/images/Docker_terminal.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Rstudio terminal"></a></p>
</figure>
</div>
<figcaption>Rstudio terminal</figcaption>
</figure>
</div>
<ul>
<li><p>Run the following command: <code>docker build  -t ricerarm_01 .</code> Note: The <code>-t</code> flag is used to tag the image with a name (in this case we are using <code>ricerarm_01</code>). The <code>.</code> at the end of the command is used to specify the current directory as the location of <code>Dockerfile</code> that is to be used.</p></li>
<li><p>After running the command you will see the Docker engine pulling the base image from the Docker Hub and then building the image. This process can take a few minutes depending on the size of the base image and the number of packages you are installing. The output in the terminal will look something like this:</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_build_output.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29" title="Docker build output in terminal"><img src="./assets/images/Docker_build_output.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker build output in terminal"></a></p>
</figure>
</div>
<figcaption>Docker build output in terminal</figcaption>
</figure>
</div>
<ul>
<li><p>Once the image has been built you can check that it is there by running the command <code>docker images</code> in the terminal. This will show you a list of all the images on your computer. You should see the image you just created in the list.</p></li>
<li><p>Alternatively you can check the image in the Docker desktop app. You will see the image in the list of images on the left of the app window. You can inspect the image by clicking on it and see the details of the image:</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_build_app.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30" title="Docker build output in app"><img src="./assets/images/Docker_build_app.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker build output in app"></a></p>
</figure>
</div>
<figcaption>Docker build output in app</figcaption>
</figure>
</div>
</section>
<section id="step-6-running-the-docker-container" class="level3">
<h3 class="anchored" data-anchor-id="step-6-running-the-docker-container">Step 6: Running the Docker container</h3>
<ul>
<li><p>The Docker command <code>run</code> is used to run a container from an image.</p></li>
<li><p><strong>This can be done through the CLI:</strong> In the terminal tab in Rstudio run the following command: <code>docker run ricerarm_01</code>.</p></li>
<li><p><strong>Or in the Docker desktop app:</strong> Click on the image you want to run and then click the run button in the top right. This will open a window where you can specify the settings for the container but for now you should just run the container with the default settings.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_image_app.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31" title="Docker images in app"><img src="./assets/images/Docker_image_app.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker images in app"></a></p>
</figure>
</div>
<figcaption>Docker images in app</figcaption>
</figure>
</div>
<ul>
<li>After running the container you can also check the status of the container in the Docker desktop app. You will see the container in the list of containers on the left of the app window. You can inspect the container by clicking on it and see the details of the container.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_container_app.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32" title="Docker containers in app"><img src="./assets/images/Docker_container_app.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker containers in app"></a></p>
</figure>
</div>
<figcaption>Docker containers in app</figcaption>
</figure>
</div>
</section>
<section id="step-8-copying-files-from-the-container-to-the-host" class="level3">
<h3 class="anchored" data-anchor-id="step-8-copying-files-from-the-container-to-the-host">Step 8 Copying files from the container to the host</h3>
<ul>
<li><p>One way to access the files created inside your container is to mount a directory from your host machine to a directory in the the container. This is done using the <code>-v</code> flag in the <code>docker run</code> command. However, this is not so effective in the example container we are using because the code is completed in a matter of seconds and after that the container is exited.</p></li>
<li><p>Instead we will copy the output files from the container using the CLI. To do this you need to know the <code>container ID</code> of the container you want to copy files from. You can get the container ID by running the command: <code>docker ps -a</code> in the terminal, this will show you a list of all the containers on your computer and in the terminal output you can copy the ID:</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_container_ID.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33" title="Docker container ID in terminal"><img src="./assets/images/Docker_container_ID.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker container ID in terminal"></a></p>
</figure>
</div>
<figcaption>Docker container ID in terminal</figcaption>
</figure>
</div>
<ul>
<li>Now you have the ID in the terminal run the command: <code>docker cp &lt;Container ID&gt;:/home/Output/Visualisations/Regional_size_summary_bar.png ./Output/</code> and replace the <code>&lt;Container ID&gt;</code> with the ID you copied. The first argument <code>/home/Output/Visualisations/Regional_size_summary_bar.png</code> is the path to the file you want to copy in the container. The second argument <code>./Output/</code> is the path to the directory to copy the file to on your host machine, again this is a relative path and the <code>.</code> specifies the current directory. After running the command you should a message printed in the terminal and the file should be copied to the directory you specified:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/Docker_copy_output.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34" title="Docker copy output in terminal"><img src="./assets/images/Docker_copy_output.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Docker copy output in terminal"></a></p>
</figure>
</div>
<figcaption>Docker copy output in terminal</figcaption>
</figure>
</div>
<p>That’s it, you have successfully created a Dockerfile, Docker image and container, run your code inside the container and copied the output back to your host machine. If you were to share the Dockerfile with someone else they could build the image and run the container on their machine and get exactly the same results as you. Obviously this is a very simple example but the same principles apply to more complex projects where reproducibility becomes more challenging.</p>
</section>
</section>
<section id="version-control-with-git-exercise" class="level2">
<h2 class="anchored" data-anchor-id="version-control-with-git-exercise">Version control with Git exercise</h2>
<p>In this exercise we will show how version control with Git can be implemented for an example R project. The project is the same that is created in the first workflow <a href="@sec-Rproj_zenodo_exercise">exercise</a>, however to save time or in case you haven’t completed this exercise we will start with the finished output from it.</p>
<p>If you would prefer to view the exercise script offline, here is a PDF version: <a href="https://www.example.com/example.zip" class="download"><i class="fa fa-download"></i> <b>Download exercise instructions</b></a></p>
<p>There is an alternative way of working with Git. Instead of linking Rstudio directly to your Github account, you can also use the Github Desktop application, which provides you with an easy to use GUI and very simple setup. If you are interested in using Github Desktop instead, skip to Step 8.</p>
<section id="step-1-download-and-configure-git" class="level3">
<h3 class="anchored" data-anchor-id="step-1-download-and-configure-git">Step 1: Download and configure Git</h3>
<ul>
<li>Download Git from https://git-scm.com/downloads</li>
<li>Once downloaded open the Git terminal window and type in the following with your credentials</li>
</ul>
<p><code>git config --global user.name "NVHarisena1" git config --global user.email "NVHarisena1\@ethz.ch" git config --global --list</code></p>
<p>The third command should return your updated user-name and email id.</p>
</section>
<section id="step-2-create-a-repository-on-github" class="level3">
<h3 class="anchored" data-anchor-id="step-2-create-a-repository-on-github">Step 2: Create a repository on Github</h3>
<p>We will make a quick repository on Github for an individual project, without changing much of the specific configurations since it will be beyond the scope of this workshop.</p>
<ul>
<li><p>Login to your account at https://github.com/</p></li>
<li><p>Create a new repository by clicking the ‘+’ sign in the top right side of the website or in the ‘Start new repository’ section in the homepage</p></li>
<li><p>Provide a clear name for the repository for e.g.&nbsp;“R_repro_nv” and a quick description like “Test for Reproducible research workshop”</p></li>
<li><p>Set the visibility of the profile to “Public”</p></li>
<li><p>Initialize this repository with: Add a README file.</p></li>
<li><p>Select a license for your repository in the “Choose your license” section. Check out <a href="https://choosealicense.com/">this website</a> to identify which license works for you. Even though it is optional to add license information to a repository, it is good practice to include this (<a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/licensing-a-repository#choosing-the-right-license">See more details</a>).</p></li>
<li><p>Click the green <code>Create repository</code> button</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35" title="Setting up the repository"><img src="./assets/images/git_ex1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Setting up the repository"></a></p>
</figure>
</div>
<figcaption>Setting up the repository</figcaption>
</figure>
</div>
</section>
<section id="step-3-link-created-repository-to-r-studio" class="level3">
<h3 class="anchored" data-anchor-id="step-3-link-created-repository-to-r-studio">Step 3: Link created repository to R-Studio</h3>
<ul>
<li><p>Open a new session in R studio and create a new project</p></li>
<li><p>In the ‘New Project Wizard’ navigate to ‘Version Control’&gt;‘Git’</p></li>
<li><p>In the “repository URL” paste the URL of your new GitHub repository. It will be something like this https://github.com/nvharisena1/R_repro_test.</p></li>
<li><p>Add folder location where you want the project to be saved locally in your computer in “Create project as subdirectory of” section</p></li>
<li><p>Click <code>Create project</code></p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36" title="Linking repository to R-Studio"><img src="./assets/images/git_ex2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Linking repository to R-Studio"></a></p>
</figure>
</div>
<figcaption>Linking repository to R-Studio</figcaption>
</figure>
</div>
<p>You will see R-studio has now been set up for your local clone of the project to communicate with your online repository. You can see a drop-down to the right of ‘New Branch’ button in the Git tab. This will show you all the branches available to pull or push data to. Your drop-down should show only a ‘main’ branch, since no new branches were created. As stated in the workflow introduction, creating branches is useful for projects with multiple collaborators or sub-themes. Pushing to different branches and then setting up a ‘pull-request’ to merge to the ‘main’ branch allows for systematic version control of the project.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37" title="R-Studio new project session with git link"><img src="./assets/images/git_ex3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="R-Studio new project session with git link"></a></p>
</figure>
</div>
<figcaption>R-Studio new project session with git link</figcaption>
</figure>
</div>
<!-- ### Step 4: Add exercise files to the local copy of the project -->
<!-- In the file navigator in the bottom right of Rstudio in the 'files' tab you will see that R-Studio has already navigated to the directory for your project. -->
<!-- -   Create two folders "Exercise" and "Data" -->
<!-- -   Copy the downloaded "exercise_data" to the two folders: "RiceFarm_project.R" to the exercise folder and the "RiceFarm.csv" to the Data folder; you can do this by navigating to the local directory of the project on windows explorer and copying the data manually. It will automatically show up in the changed files as detected by Git. -->
<!-- You will see that the changes are shown in the Git tab in the top right panel in R-Studio with status and path details of each change. -->
<!-- ![Adding data to project](./assets/images/git_ex4.png){width="70%" fig-align="center"} -->
</section>
<section id="step-5-edit-the-readme.md-file" class="level3">
<h3 class="anchored" data-anchor-id="step-5-edit-the-readme.md-file">Step 5: Edit the <code>README.md</code> file</h3>
<ul>
<li><p>Open the README.md from the file viewer pane</p></li>
<li><p>Add a description section for the project with a heading and a describing sentence, for e.g.&nbsp;“This project is is a test”.</p></li>
<li><p>Add license information for the project, for e.g.&nbsp;“This project is licensed under the terms of the MIT license.”</p></li>
<li><p>Save the file.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38" title="Edit README.md"><img src="./assets/images/git_ex5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Edit README.md"></a></p>
</figure>
</div>
<figcaption>Edit README.md</figcaption>
</figure>
</div></li>
</ul>
</section>
<section id="step-6-edit-the-.gitignore-file" class="level3">
<h3 class="anchored" data-anchor-id="step-6-edit-the-.gitignore-file">Step 6: Edit the <code>.gitignore</code> file</h3>
<p>The git ignore functionality tells git which files to ignore while ‘pushing’ the local changes to the remote (online) repository <a href="https://git-scm.com/docs/gitignore/en">see more details</a>.In this example we will tell git to ignore all <code>.html</code> files. <code>.html</code> files are created when you preview a file, for example click preview on the edited <code>README.md</code> and a <code>.html</code> should be created.</p>
<ul>
<li>Open the <code>.gitignore</code> file and add <code>.html</code> in a new line and save the file</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39" title="Editing the .gitignore file"><img src="./assets/images/git_ex6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Editing the .gitignore file"></a></p>
</figure>
</div>
<figcaption>Editing the .gitignore file</figcaption>
</figure>
</div>
</section>
<section id="step-7-commit-and-push" class="level3">
<h3 class="anchored" data-anchor-id="step-7-commit-and-push">Step 7: Commit and push</h3>
<ul>
<li><p>Click the <code>Commit</code> button in the Git tab</p></li>
<li><p>Check all the files listed in the top left section</p></li>
<li><p>Write a sentence describing the changes i.e.&nbsp;<em>“Updated exercise, data, Readme and .gitignore”</em></p></li>
<li><p>Click <code>Commit</code> and close the window</p></li>
<li><p>click <code>Push</code> in the Git tab, a window will pop up showing the interface with the remote system and details of the upload.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex7.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40" title="Commit changes"><img src="./assets/images/git_ex7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Commit changes"></a></p>
</figure>
</div>
<figcaption>Commit changes</figcaption>
</figure>
</div>
<p>Great! You have finished your first project update (local changes committed and pushed) via Git on Rstudio.</p>
</section>
<section id="step-8-download-and-install-github-desktop" class="level3">
<h3 class="anchored" data-anchor-id="step-8-download-and-install-github-desktop">Step 8: Download and install Github Desktop</h3>
<p>This is an alternative way to work with Github when coding in R. For this, we will not link Rstudio to our Github account but we will use the Github Desktop application instead.</p>
<ul>
<li><p>Download <a href="https://github.com/apps/desktop">Github Desktop</a></p></li>
<li><p>Install the application and login with your Github account</p></li>
</ul>
</section>
<section id="step-9-create-a-repository-on-github" class="level3">
<h3 class="anchored" data-anchor-id="step-9-create-a-repository-on-github">Step 9: Create a repository on Github</h3>
<p>We will make a quick repository on Github for an individual project, without changing much of the specific configurations since it will be beyond the scope of this workshop.</p>
<ul>
<li><p>Login to your account on <a href="https://github.com/">Github</a></p></li>
<li><p>Create a new repository by clicking the ‘+’ sign in the top right side of the website or in the ‘Start new repository’ section in the homepage</p></li>
<li><p>Provide a clear name for the repository for e.g.&nbsp;“R_repro_nv” and a quick description like “Test for Reproducible research workshop”</p></li>
<li><p>Set the visibility of the profile to “Public”</p></li>
<li><p>Initialize this repository with: Add a README file.</p></li>
<li><p>Select a license for your repository in the “Choose your license” section. Check out <a href="https://choosealicense.com/">this website</a> to identify which license works for you. Even though it is optional to add license information to a repository, it is good practice to include this (<a href="https://docs.github.com/en/repositories/managing-your-repositorys-settings-and-features/customizing-your-repository/licensing-a-repository#choosing-the-right-license">See more details</a>).</p></li>
<li><p>Click the green <code>Create repository</code> button</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_ex1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41" title="Setting up the repository"><img src="./assets/images/git_ex1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Setting up the repository"></a></p>
</figure>
</div>
<figcaption>Setting up the repository</figcaption>
</figure>
</div>
</section>
<section id="step-10-clone-your-github-repository-to-your-computer" class="level3">
<h3 class="anchored" data-anchor-id="step-10-clone-your-github-repository-to-your-computer">Step 10: Clone your Github repository to your computer</h3>
<ul>
<li>In the Github Desktopp application click ‘File’&gt;‘Clone Repository’ and select your new repository. Define the directory on your computer, where you want to clone the repository to. Press the <code>Clone</code> button.</li>
</ul>
</section>
<section id="step-11-edit-the-readme.md-file" class="level3">
<h3 class="anchored" data-anchor-id="step-11-edit-the-readme.md-file">Step 11: Edit the <code>README.md</code> file</h3>
<ul>
<li><p>Open the README.md in your local project directory with a text editor.</p></li>
<li><p>Add a description section for the project with a heading and a describing sentence, for e.g.&nbsp;“This project is is a test”.</p></li>
<li><p>Add license information for the project, for e.g.&nbsp;“This project is licensed under the terms of the MIT license.”</p></li>
<li><p>Save the file.</p></li>
</ul>
</section>
<section id="step-12-push-the-updated-readme.md-file" class="level3">
<h3 class="anchored" data-anchor-id="step-12-push-the-updated-readme.md-file">Step 12: Push the updated <code>README.md</code> file</h3>
<p>Since you have edited the <code>README.md</code> file, Github Desktopp app will propose to you to push this change from your computer to your repository.</p>
<ul>
<li><p>Add a title and a description and click <code>Commit to main</code> button.</p></li>
<li><p>Click <code>Push origin</code> button to upload your changes to your repository on Github.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./assets/images/git_exercise_commit.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42" title="Commiting changes github"><img src="./assets/images/git_exercise_commit.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Commiting changes github"></a></p>
</figure>
</div>
<figcaption>Commiting changes github</figcaption>
</figure>
</div>
</section>
</section>
<section id="sec-Quarto_exercise" class="level2">
<h2 class="anchored" data-anchor-id="sec-Quarto_exercise">Writing an academic paper with Quarto</h2>
<p>In this exercise we will start to write an academic manuscript using Quarto and incorporating data from the example R project we have used in the other exercises. The project is the same that is created in the first workflow <a href="@sec-Rproj_zenodo_exercise">exercise</a>, however to save time or in case you haven’t completed this exercise we will start with the finished output from it.</p>
<p>If you would prefer to view the exercise script offline, here is a PDF version: <a href="https://blenback.github.io/R-for-Reproducible-Research/exercises/Quarto-manuscript_exercise.pdf" class="download"><i class="fa fa-download"></i> <b>Download exercise instructions</b></a></p>
<section id="step-1-download-the-resources-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-download-the-resources-1">Step 1: Download the resources</h3>
<ul>
<li><p>Click here to download the resources for the exercise: <a href="https://drive.google.com/uc?export=download&amp;id=1TN3DZqetynnNWlTeV2eKqJDcU53fq9Zg" class="download"><i class="fa fa-download"></i> <b>Download resources for exercise</b></a></p></li>
<li><p>Unzip the downloaded file and move the folder to a location on your computer where you can easily find it.</p></li>
</ul>
</section>
<section id="step-2-open-the-project-in-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="step-2-open-the-project-in-rstudio">Step 2: Open the project in RStudio</h3>
<ul>
<li>Open RStudio and navigate to the folder where you saved the resources for the exercise.</li>
<li>Open the Rstudio project file in the directory (<code>Rice_farm_analysis.Rproj</code>)</li>
</ul>
</section>
<section id="step-3-download-quarto" class="level3">
<h3 class="anchored" data-anchor-id="step-3-download-quarto">Step 3: Download Quarto</h3>
<ul>
<li><p><strong>Note</strong>: Because Quarto is bundled with Rstudio if you have a recent version of Rstudio you may already have Quarto installed. To check go to <em>File &gt; New File</em> and you should see <em>Quarto</em> Document as an option.</p></li>
<li><p>If you do not have Quarto installed you can install it from the Quarto website <a href="https://quarto.org/docs/download/">here</a></p></li>
</ul>
</section>
<section id="step-4-create-a-quarto-document-for-the-article-content" class="level3">
<h3 class="anchored" data-anchor-id="step-4-create-a-quarto-document-for-the-article-content">Step 4: Create a Quarto document for the article content</h3>
<p>The Quarto website provides a <a href="https://github.com/quarto-ext/manuscript-template-rstudio">template</a> for creating a Manuscript project but we will create one from scratch so that you understand the various files.</p>
<ul>
<li>The 1st step is to create a Quarto document that will act as the primary content file, go to <em>File &gt; New File &gt; Quarto Document</em>. You don’t need to add title or author information in the wizard as we will do this in the document itself.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/quarto-new-file.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43" title="Quarto document wizard"><img src="assets/images/quarto-new-file.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%" alt="Quarto document wizard"></a></p>
</figure>
</div>
<figcaption>Quarto document wizard</figcaption>
</figure>
</div>
<ul>
<li>Save the file as <code>index.qmd</code> in the root directory of the project. Using <code>index</code> as the file name is the convention for the main content file in a Quarto project and the software will look for this when attempting to create an output of the content. However it is possible to use a different file name if you prefer but it requires setting an option in the configuration file.</li>
</ul>
</section>
<section id="step-5-create-a-_quarto.yml-configuration-file" class="level3">
<h3 class="anchored" data-anchor-id="step-5-create-a-_quarto.yml-configuration-file">Step 5: Create a <code>_quarto.yml</code> configuration file</h3>
<p><a href="https://en.wikipedia.org/wiki/YAML">YAML</a> files (<code>.yml</code>) are configuration files, and in the case of Quarto the convention is to use a file named <code>_quarto.yml</code> in the root directory of the project. This file will be used to set a range of options including the project type, code execution options and options for the output format/s.</p>
<ul>
<li>Create a new file with <em>File &gt; New File &gt; Text File</em> and save it to the root directory of the project and name it <code>_quarto.yml</code>. Adding the extension <code>.yml</code> will automatically set the file type to YAML.</li>
</ul>
</section>
<section id="step-6-specify-the-manuscript-project-type-in-the-configuration-file" class="level3">
<h3 class="anchored" data-anchor-id="step-6-specify-the-manuscript-project-type-in-the-configuration-file">Step 6: Specify the <code>Manuscript</code> project type in the configuration file</h3>
<ul>
<li><p><strong>Note</strong>: All YAML options are set using <a href="https://www.commonwl.org/user_guide/topics/yaml-guide.html#key-value-pairs">key-value pairs</a> and the Quarto documentation provides a <a href="https://quarto.org/docs/projects/quarto-projects.html">list of options</a> that can be set in the configuration file.</p></li>
<li><p>The first step is to identify your project as a manuscript by entering the following code in the <code>_quarto.yml</code> file:</p></li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>_quarto.yml</strong></pre>
</div>
<div class="sourceCode" id="cb33" data-filename="_quarto.yml"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">project</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> manuscript</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>If you do want your main content file to be named something other than <code>index.*</code> you can add the file name with the <code>article</code> key (but make sure that your <code>.qmd</code> file name matches the entry):</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>_quarto.yml</strong></pre>
</div>
<div class="sourceCode" id="cb34" data-filename="_quarto.yml"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">manuscript</span><span class="kw">:</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">article</span><span class="kw">:</span><span class="at"> Rice_farm.qmd</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-7-set-output-formats-in-the-configuration-file" class="level3">
<h3 class="anchored" data-anchor-id="step-7-set-output-formats-in-the-configuration-file">Step 7: Set output formats in the configuration file</h3>
<p>The next step is to set the output formats for the document. Quarto supports outputting your manuscript to a range of formats simultaneously including HTML, PDF, Docx and LaTeX. The output formats and their individual options are also set in the <code>_quarto.yml</code> file.</p>
<ul>
<li>For this exercise we will set the output formats to HTML, docx and PDF. Add the following code to the <code>_quarto.yml</code> file:</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>_quarto.yml</strong></pre>
</div>
<div class="sourceCode" id="cb35" data-filename="_quarto.yml"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">comments</span><span class="kw">:</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">hypothesis</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">docx</span><span class="kw">:</span><span class="at"> default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>For PDF outputs specifically, there a number of templates that have been produced to align with the formatting of major academic publishers. These are available as <a href="https://quarto.org/docs/extensions/listing-journals.html">Quarto extensions</a>.</p></li>
<li><p>For this exercise we will use the <a href="https://github.com/quarto-journals/elsevier">Elsevier template</a>. Quarto extensions can be installed directly using the terminal in Rstudio. To install the Elsevier template run the following code in the terminal: <code>quarto add quarto-journals/elsevier</code></p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/quarto-elsevier-install.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="assets/images/quarto-elsevier-install.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<ul>
<li>Once the template is installed you can set the PDF output to use the template by adding the following code to the <code>_quarto.yml</code> file indented below the existing <code>format</code> entry:</li>
</ul>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>_quarto.yml</strong></pre>
</div>
<div class="sourceCode" id="cb36" data-filename="_quarto.yml"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">elsevier-pdf</span><span class="kw">:</span><span class="at"> default</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-8-complete-the-front-matter-content" class="level3">
<h3 class="anchored" data-anchor-id="step-8-complete-the-front-matter-content">Step 8: Complete the front matter content</h3>
<p>The front matter of the document is where you can enter the title, author/s and other metadata for the document. In the case of academic manuscripts this also includes the abstract, keywords, author institutions and roles (according to the <a href="https://authorservices.wiley.com/author-resources/Journal-Authors/open-access/credit.html">CRediT Taxonomy</a>). The full list of front matter options for Quarto manuscripts can be found <a href="https://quarto.org/docs/authoring/front-matter.html">here</a>.</p>
<p>Front matter is entered as YAML content at the start of the main content file <code>index.qmd</code>. To be recognised as YAML content it must be enclosed by three dashes <code>---</code> at the start and end of the content block.</p>
<ul>
<li>Enter example front matter for this exercise as follows:</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> An Analysis of Rice Production in Indonesia</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Jane Doe</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">orcid</span><span class="kw">:</span><span class="at"> 0000-0002-0760-5497</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">corresponding</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">email</span><span class="kw">:</span><span class="at"> Janedoe@gmail.com</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">roles</span><span class="kw">:</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Investigation</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Project administration</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Software</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> Visualization</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">affiliations</span><span class="kw">:</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> ETH_PLUS</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> ETH Zürich</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">department</span><span class="kw">:</span><span class="at"> Planning of Landscape and Urban Systems (PLUS) Institut für Raum- und Landschaftsentwicklung (IRL)</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">address</span><span class="kw">:</span><span class="at"> HIL H 52.1, Stefano-Franscini-Platz 5</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">city</span><span class="kw">:</span><span class="at"> Zürich</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">postal-code</span><span class="kw">:</span><span class="at"> </span><span class="dv">8093</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> John Doe</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">orcid</span><span class="kw">:</span><span class="at"> 0000-0002-7859-8394</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">corresponding</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">roles</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">affiliations</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">id</span><span class="kw">:</span><span class="at"> ETH_PLUS</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="fu">keywords</span><span class="kw">:</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Rice farms</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Indonesia</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> Regional production</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abstract</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>  This is the abstract</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plain-language-summary</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>  Rice production data for the country of Indonesia is analysed ...</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> last-modified</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a><span class="fu">number-sections</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now take some time to practice editing this content by, for example, changing the title, adding yourself as an author or changing the abstract. You will see that indentation is very important for YAML content to work correctly.</p>
<p>One nice feature is the fact that you can use the <code>affiliation: id</code> option to avoid needing to repeat details for authors from the same institution.</p>
</section>
<section id="step-7-add-manuscript-content" class="level3">
<h3 class="anchored" data-anchor-id="step-7-add-manuscript-content">Step 7: Add manuscript content</h3>
<p>Now we have our manuscript project and content file set up let’s add some content. Content in Quarto files is written in <a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> format, which takes some getting used to but will quickly become intuitive.</p>
<ul>
<li>Add some content to the <code>index.qmd</code> file. For example, use <code>#</code> to create a heading and <code>##</code> for subheadings:</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>Rice is a staple food in Indonesia and is grown in many regions across the country. The production of rice is a key economic activity in Indonesia and is a major source of employment for many people. In this study we analyse the production of different types of rice in different regions in Indonesia.  </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methods</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>For this study we used data from the Indonesian Ministry of Agriculture on rice production in the country. The data was collected from different regions across Indonesia and includes information on the types of rice grown, the amount of rice produced and the area of land used for rice cultivation.</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>Figure 1 shows the distribution of rice production across different regions in Indonesia. Table 1 shows the types of rice grown in each region and the amount of rice produced.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now lets render our manuscript for the first time to see how the output looks. To render the document click the <code>Render</code> button in the top of the Rstudio source pane:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/rstudio-render-button.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="assets/images/rstudio-render-button.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<p>This will render the document to HTML and open it in the viewer pane on the right:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/quarto-html-output.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="assets/images/quarto-html-output.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</section>
<section id="step-8-add-figures-and-tables" class="level3">
<h3 class="anchored" data-anchor-id="step-8-add-figures-and-tables">Step 8: Add Figures and Tables</h3>
<p>Figures and tables can be added to quarto documents using code blocks in various programming languages. To add a code block into a Quarto document you use three backticks followed by the language name in braces, for example an R chunk would be: <code>```{r}</code> and then close the block with another three backticks. Code blocks are executed when the document is rendered and the output is included in the final document (although this behaviour can be controlled with <a href="https://quarto.org/docs/computations/execution-options.html">execution options</a>).</p>
<p>Lets add a figure to the document using the R code from the exercise script <code>Scripts/02_data_visualisation.R</code> to create a bar chart of the area of farms growing different types in different regions in Indonesia.</p>
<ul>
<li>Add the following code block to the <code>index.qmd</code> file below the <code>Results</code> heading:</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required packages</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="in"># load the summarized data</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="in">rice_data_summary &lt;- read.csv("Data/Processed/RiceFarms_summary.csv")</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="in"># plot summary data as grouped bar chart</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(rice_data_summary, aes(x=region, y=size, fill=varieties)) +</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar(stat="identity", position="dodge") +</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title="Total size of farms by region and rice varieties",</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="in">       x="Region",</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="in">       y="Total size of farms",</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="in">       fill="Rice varieties") +</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 45, hjust = 1))</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now if you re-render the document you should see the figure included in the output.</p>
</section>
<section id="step-9-add-cross-references" class="level3">
<h3 class="anchored" data-anchor-id="step-9-add-cross-references">Step 9: Add Cross-references</h3>
<p>Quarto allows you to <a href="https://quarto.org/docs/authoring/cross-references.html">cross-reference</a> figures, tables and sections in your document.</p>
<ul>
<li>Add a label to the figure code block by adding the following line at the top of the code block:</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-barchart</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Now add a cross-reference to this figure in the text by changing the word <code>Figure 1</code> to <code>@fig-barchart</code> in the 1st sentence of the <code>Results</code> section:</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>@fig-barchart shows the distribution of rice production across different regions in Indonesia. Table 1 shows the types of rice grown in each region and the amount of rice produced.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Now if you re-render the document you will see that the figure has been automatically numbered and the text now contains a hyperlinked cross reference to the figure:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/quarto-figure-cross-reference.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="assets/images/quarto-figure-cross-reference.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
</section>
<section id="step-10-add-citations" class="level3">
<h3 class="anchored" data-anchor-id="step-10-add-citations">Step 10: Add citations</h3>
<p>Quarto provides the functionality to not only add citations to your documents but to automatically generate a bibliography, both of which can be formatted according to a wide range of citation styles to meet journal requirements. For a detailed explanation of citations with Quarto see the guide <a href="https://quarto.org/docs/authoring/citations.html">here</a>.</p>
<p>Quarto uses the standard Pandoc markdown representation for citations, whereby citations go inside square brackets and are separated by semicolons, e.g.&nbsp;<code>[@citation]</code>. Citations can be entered manually however they need to have a corresponding entry in the articles bibliography file (a <code>.bib</code> or <code>.csl</code> file in the root directory of the project). Instead, we will add a citation using the wizard in the <a href="https://quarto.org/docs/visual-editor/">Quarto visual editor</a> which will automatically create the citation entry in the bibliography file.</p>
<ul>
<li>At the top of the source pane click the <code>Visual</code> button to switch to the visual editor:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/visual-editing-switch-modes.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="assets/images/visual-editing-switch-modes.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<ul>
<li>Navigate the methods section and position the cursor at the end of the sentence:</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>For this study we used data from the Indonesian Ministry of Agriculture on rice production in the country.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>In the Visual editor tool bar at the top the top of the source pane click <em>Insert</em> and in the drop down menu select <em>Citation</em> (or alternatively use the keyboard shortcut <em>Ctrl + Shift + F8</em> on windows). This will open the <strong>Insert Citation</strong> wizard:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/insert_citation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="assets/images/insert_citation.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<ul>
<li>The Rice Farms data used for the exercises comes from the <a href="https://rdrr.io/rforge/plm/man/RiceFarms.html"><code>plm</code></a> package so we will cite this as an example (even though it is totally accurate in terms of the sentence content). Click on the tab for R packages on the left side of the wizard, enter <strong>plm</strong> in the search bar and click on the entry in the window below to select it:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="assets/images/cite-plm.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="assets/images/cite-plm.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></a></p>
</figure>
</div>
<ul>
<li><p>Make sure the <strong>Create</strong> box in the bottom left corner of the wizard has a value in it, the default should be <code>references.bib</code>.</p></li>
<li><p>Now click <strong>Insert</strong> and the wizard will close, you will see that the citation has been added at the cursor location and a <code>references.bib</code> has been created in the root directory of the project. If you openthis file you can see the bibliographic details of the citation (Note if you have previously added citations or already created a <code>references.bib</code> file citations will all be added to the same file.</p></li>
</ul>
<p>Now when you render the document this citation will automatically be hyperlinked to the corresponding entry in the bibliography that is appended to the end of the document.</p>
<p><strong>Tip:</strong> In our experience the easiest method of adding academic citations is to use the <a href="https://quarto.org/docs/visual-editor/technical.html#citations-from-zotero">Quarto-Zotero</a> integration. In this case you select the Zotero tab in the <strong>Insert Citation</strong> wizard and if Zotero is running on your computer you will be able to search your whole library to add citations.</p>
</section>
<section id="summary-1" class="level3">
<h3 class="anchored" data-anchor-id="summary-1">Summary</h3>
<p>In this exercise we have only touched upon a few of the many of the useful features of Quarto for writing reproducible research documents. As such we would urge you to look through the <a href="https://quarto.org/docs/guide/">Quarto documentation</a> to learn about some of the other features as well as useful packages and extensions such as the <a href="https://claudiozandonella.github.io/trackdown/">trackdown</a> package which allows you to convert Quarto documents in Google docs (and back to Quarto again) to facilitate collaboration with users not familiar with the format.</p>
<!-- # Resources {#sec-resources} -->
</section>
</section>
<section id="r-and-git" class="level2">
<h2 class="anchored" data-anchor-id="r-and-git">R and Git</h2>
<p>[<img src="assets/images/blog.dark.svg" style="vertical-align:middle; height:1em;"> to <img src="assets/images/blog.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline] https://rstudio.github.io/renv/articles/renv.html</p>
<p>[<img src="assets/images/website.dark.svg" style="vertical-align:middle; height:1em;"> to <img src="assets/images/website.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline] https://intro2r.com/</p>
<p>https://docs.github.com/en/get-started/getting-started-with-git</p>
</section>
<section id="quarto-11" class="level2">
<h2 class="anchored" data-anchor-id="quarto-11">Quarto</h2>
<p>[&lt;img src=“img src=”assets/images/video.dark.svg” style=“vertical-align:middle; height:1em;”/&gt; to <img src="assets/images/video.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline] https://youtu.be/w3X76e_tZr8?si=bE4OfrNm-wLaeBlk</p>
<p>https://youtu.be/EbAAmrB0luA?si=yUXEup4qpRXCDh5k</p>
<p>[<img src="assets/images/blog.dark.svg" style="vertical-align:middle; height:1em;"> to <img src="assets/images/blog.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline] https://www.marvinschmitt.com/blog/website-tutorial-quarto/</p>
<p>https://marioangst.com/en/blog/posts/multi-language-quarto/</p>
</section>
<section id="zenodo" class="level2">
<h2 class="anchored" data-anchor-id="zenodo">Zenodo</h2>
<p>[<img src="assets/images/website.dark.svg" style="vertical-align:middle; height:1em;"> to <img src="assets/images/website.dark.svg" style="vertical-align:0%; height:0.85em;"> pipeline] https://cran.r-project.org/web/packages/zen4R/vignettes/zen4R.html</p>



</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/blenback\.github\.io\/R-for-Reproducible-Research\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><i class="fa-regular fa-copyright" aria-label="copyright"></i> Benjamin Black, 2024<br> All content licensed under <i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> <i class="fa-brands fa-creative-commons-sa" aria-label="creative-commons-sa"></i> <i class="fa-brands fa-creative-commons-nc" aria-label="creative-commons-nc"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC BY-NC-SA 4.0)</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a><br></p>
</div>
  </div>
</footer>
<script type="application/javascript" src="light-dark.js"></script>
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","loop":false,"closeEffect":"zoom","descPosition":"bottom","openEffect":"zoom"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>